<!DOCTYPE html><html lang="en"> <head><!-- Global Metadata --><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" type="image/png" href="/src/assets/icon.png"><link rel="stylesheet" href="/styles/global.css"><link rel="sitemap" href="/sitemap-index.xml"><link rel="alternate" type="application/rss+xml" title="èŒ¶ç†çš„åšå®¢" href="https://charlesix59.github.io/rss.xml"><meta name="generator" content="Astro v5.16.6"><!-- Font preloads --><link rel="preload" href="/fonts/atkinson-regular.woff" as="font" type="font/woff" crossorigin><link rel="preload" href="/fonts/atkinson-bold.woff" as="font" type="font/woff" crossorigin><!-- Canonical URL --><link rel="canonical" href="https://charlesix59.github.io/page/6/"><!-- Primary Meta Tags --><title>èŒ¶ç†çš„åšå®¢ - ç¬¬ 6 é¡µ</title><meta name="title" content="èŒ¶ç†çš„åšå®¢ - ç¬¬ 6 é¡µ"><meta name="description" content="Welcome to my website! - ç¬¬ 6 é¡µï¼Œå…± 7 é¡µ"><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://charlesix59.github.io/page/6/"><meta property="og:title" content="èŒ¶ç†çš„åšå®¢ - ç¬¬ 6 é¡µ"><meta property="og:description" content="Welcome to my website! - ç¬¬ 6 é¡µï¼Œå…± 7 é¡µ"><meta property="og:image" content="https://charlesix59.github.io/_astro/default.DOL7xRHI.png"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://charlesix59.github.io/page/6/"><meta property="twitter:title" content="èŒ¶ç†çš„åšå®¢ - ç¬¬ 6 é¡µ"><meta property="twitter:description" content="Welcome to my website! - ç¬¬ 6 é¡µï¼Œå…± 7 é¡µ"><meta property="twitter:image" content="https://charlesix59.github.io/_astro/default.DOL7xRHI.png"><link rel="stylesheet" href="/_astro/about.CafuXOta.css">
<style>.card-link[data-astro-cid-dohjnao5]{text-decoration:none;color:inherit}.card[data-astro-cid-dohjnao5]{display:flex;gap:1.5rem;padding:1.5rem;border-radius:0;transition:all .3s ease;background:#fff;box-shadow:0 2px 8px #0000001a}.card[data-astro-cid-dohjnao5]:hover{box-shadow:0 4px 16px #00000026;transform:translateY(-2px)}.card-image[data-astro-cid-dohjnao5]{flex-shrink:0;width:10rem;height:10rem;border-radius:0;overflow:hidden;background:#f0f0f0}.card-image[data-astro-cid-dohjnao5] img[data-astro-cid-dohjnao5]{width:100%;height:100%;object-fit:cover}.card-content[data-astro-cid-dohjnao5]{flex:1;display:flex;flex-direction:column;justify-content:center;min-width:0}.card-title[data-astro-cid-dohjnao5]{margin:0 0 .5rem;font-size:1.1rem;font-weight:600;color:rgb(var(--black));line-height:1.4;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.card-description[data-astro-cid-dohjnao5]{margin:0;font-size:.95rem;color:rgb(var(--gray));line-height:1.5;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;text-overflow:ellipsis}@media(max-width:640px){.card[data-astro-cid-dohjnao5]{padding:1rem;gap:1rem}.card-image[data-astro-cid-dohjnao5]{width:8rem;height:8rem}.card-title[data-astro-cid-dohjnao5]{font-size:1rem}.card-description[data-astro-cid-dohjnao5]{font-size:.9rem;-webkit-line-clamp:1}}.card-list[data-astro-cid-p3vyftr4]{display:flex;flex-direction:column;gap:2px;margin-top:2rem}.card-item[data-astro-cid-p3vyftr4]{background:transparent}@media(max-width:640px){.card-list[data-astro-cid-p3vyftr4]{gap:2px;margin-top:1.5rem}}.pagination[data-astro-cid-d776pwuy]{display:flex;justify-content:center;align-items:center;gap:.6rem;margin:2rem 0;flex-wrap:wrap;font-size:.95rem}.pagination-link[data-astro-cid-d776pwuy]{padding:.35rem .8rem;background-color:#e8e8e8;color:#333;text-decoration:none;border-radius:6px;font-weight:500;transition:all .3s ease;border:1px solid #d0d0d0;font-size:.9rem}.pagination-link[data-astro-cid-d776pwuy]:hover{background-color:#d8d8d8;transform:translateY(-2px);box-shadow:0 2px 8px #0000001a}.pagination-numbers[data-astro-cid-d776pwuy]{display:flex;gap:.3rem;align-items:center}.pagination-number[data-astro-cid-d776pwuy]{padding:.3rem .6rem;border:1px solid #d0d0d0;color:#333;background-color:#fff;text-decoration:none;border-radius:4px;font-weight:500;transition:all .3s ease;min-width:2rem;text-align:center;font-size:.9rem}.pagination-number[data-astro-cid-d776pwuy]:hover:not(.active){background-color:#f5f5f5;border-color:#999}.pagination-number[data-astro-cid-d776pwuy].active{background-color:#333;color:#fff;border-color:#333}.pagination-ellipsis[data-astro-cid-d776pwuy]{color:rgb(var(--gray));font-weight:500;padding:.3rem .2rem;font-size:.9rem}@media(max-width:640px){.pagination[data-astro-cid-d776pwuy]{gap:.5rem;margin:2rem 0}.pagination-link[data-astro-cid-d776pwuy]{padding:.4rem .7rem;font-size:.9rem}.pagination-number[data-astro-cid-d776pwuy]{padding:.3rem .6rem;font-size:.9rem}.pagination-numbers[data-astro-cid-d776pwuy]{gap:.3rem}}
</style></head> <body> <header data-astro-cid-3ef6ksr2> <nav data-astro-cid-3ef6ksr2> <h2 data-astro-cid-3ef6ksr2><a href="/" data-astro-cid-3ef6ksr2>èŒ¶ç†çš„åšå®¢</a></h2> <div class="internal-links" data-astro-cid-3ef6ksr2> <a href="/" data-astro-cid-3ef6ksr2="true" data-astro-cid-eimmu3lg> é¦–é¡µ </a>  <a href="/tags" data-astro-cid-3ef6ksr2="true" data-astro-cid-eimmu3lg> æ ‡ç­¾ </a>  <a href="/about" data-astro-cid-3ef6ksr2="true" data-astro-cid-eimmu3lg> å…³äºæˆ‘ </a>  </div> <div class="social-links" data-astro-cid-3ef6ksr2> <a href="https://https://github.com/charlesix59" target="_blank" data-astro-cid-3ef6ksr2> <span class="sr-only" data-astro-cid-3ef6ksr2>find me on Github</span> <svg viewBox="0 0 16 16" aria-hidden="true" width="32" height="32" data-astro-cid-3ef6ksr2><path fill="currentColor" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z" data-astro-cid-3ef6ksr2></path></svg> </a> </div> </nav> </header>  <main> <div style="margin-bottom: 2rem; text-align: center;"> <h1 style="margin: 0; font-size: 2rem; color: rgb(var(--black));">
åšå®¢åˆ—è¡¨ - ç¬¬ 6 é¡µ
</h1> <p style="color: rgb(var(--gray)); margin: 0.5rem 0 0 0;">
å…± 92 ç¯‡æ–‡ç« 
</p> </div> <div class="card-list" data-astro-cid-p3vyftr4> <div class="card-item" data-astro-cid-p3vyftr4> <a href="/blog/technology/program/fix_lombok_cant_add_bug/" class="card-link" data-astro-cid-dohjnao5> <div class="card" data-astro-cid-dohjnao5> <div class="card-image" data-astro-cid-dohjnao5>  </div> <div class="card-content" data-astro-cid-dohjnao5> <h3 class="card-title" data-astro-cid-dohjnao5>è§£æ±ºspring booté˜¿é‡Œäº‘é¡åƒç«™æ— æ³•æ·»åŠ lombokçš„é—®é¢˜</h3> <p class="card-description" data-astro-cid-dohjnao5>æœ€è¿‘åœ¨å†™spring bootçš„æ—¶å€™å‘ç”Ÿä¸€ä¸ªæŒºè®©äººæ— è¯­çš„é—®é¢˜ï¼Œåœ¨å¼•å…¥lombokçš„æ—¶å€™mavenæŠ¥é”™äº†,æŠ¥é”™ä¿¡æ¯ç±»ä¼¼ä¸‹é¢ï¼š

```shell
Cannot resolve org.springframework.boot:spring-boot-starter-data-elasticsearch:pom:2.7.3 failed to transfer from http://maven.aliyun.com/nexus/content/groups/public during a previous attempt. This failure was cached in the local repository and resolution is not reattempted until the update interval of nexus-aliyun has elapsed or updates are forced. Original error: Could not transfer artifact org.springframework.boot:spring-boot-starter-data-elasticsearch:pom:2.7.3 from/to nexus-aliyun (http://maven.aliyun.com/nexus/content/groups/public): transfer failed for http://maven.aliyun.com/nexus/content/groups/public/org/springframework/boot/spring-boot-starter-data-elasticsearch/2.7.3/spring-boot-starter-data-elasticsearch-2.7.3.pom
```

ä¹‹å‰æ²¡æœ‰é‡åˆ°è¿‡è¿™ç§æƒ…å†µï¼Œå¯èƒ½å½“å¤©é˜¿é‡Œäº‘æŠ½äº†ç‚¹é£å§ã€‚ï¼ˆä»Šå¤©å·²ç»æ¢å¤æ­£å¸¸äº†ï¼Œå¯ä»¥æ­£å¸¸å¼•å…¥lombokï¼‰
æˆ‘çš„è§£å†³æ–¹æ¡ˆæ˜¯ï¼š

é€€åˆ°1.18.20ï¼ˆé€€äº†ä¸¤ä¸ªç‰ˆæœ¬ï¼‰

ç›´æ¥åœ¨Javaä»£ç é‡Œé¢å†™`import lombok.Data`ï¼ŒIDEAä¹Ÿæœ‰ä¸€å®šçš„æ¦‚ç‡ç›´æ¥å¼•å…¥å¯ç”¨çš„ç‰ˆæœ¬</p> </div> </div> </a>  </div><div class="card-item" data-astro-cid-p3vyftr4> <a href="/blog/technology/js/best_practice_of_indexdb_cursor/" class="card-link" data-astro-cid-dohjnao5> <div class="card" data-astro-cid-dohjnao5> <div class="card-image" data-astro-cid-dohjnao5>  </div> <div class="card-content" data-astro-cid-dohjnao5> <h3 class="card-title" data-astro-cid-dohjnao5>IndexDBæ¸¸æ ‡çš„æ­£ç¡®æ‰“å¼€æ–¹å¼</h3> <p class="card-description" data-astro-cid-dohjnao5># IndexDBæ¸¸æ ‡çš„æ­£ç¡®æ‰“å¼€æ–¹å¼

## å¼•è¨€

æˆ‘æœ€è¿‘åœ¨ç»´æŠ¤æˆ‘çš„ç©å…·é¡¹ç›®`react-door`ï¼Œå½“æˆ‘è¯•å›¾ä½¿ç”¨IndexDBçš„æ¸¸æ ‡éå†æŸä¸ªè¡¨æ—¶ï¼Œæˆ‘é‡åˆ°äº†ä¸€äº›è®©äººååˆ†å›°æƒ‘çš„é—®é¢˜ï¼Œä¸‹é¢æˆ‘å°†å¸¦å¤§å®¶æ¥å¤ç°ä¸€ä¸‹äº‹æ•…çš„ç°åœºã€‚

## å¤ç°

é¦–å…ˆï¼Œåœ¨æˆ‘çš„å°è±¡ä¸­ï¼Œæ¸¸æ ‡ç±»ä¼¼è¿­ä»£å™¨ï¼Œæ‰€ä»¥åˆšå¼€å§‹æˆ‘è¯•å›¾æ‹¿åˆ°æ¸¸æ ‡ä¼ é€’å‡ºå»ç„¶ååœ¨daoå±‚è°ƒç”¨ï¼š

```js
// indexDB.js
// è·å–cursor
const getCursor = () =&gt; {
    if (!db) {
        return Promise.reject(&quot;database connect instance can&#39;t be null&quot;)
    }
    const store = db.transaction(storeName, &#39;readonly&#39;).objectStore(storeName)
    const request = store.openCursor();
    return new Promise((resolve, reject) =&gt; {
        request.onsuccess = (e) =&gt; {
            const cursor = e.target[&quot;result&quot;]
            resolve(cursor)
        }
        request.onerror = (e) =&gt; {
            reject(e)
        }
    })
}


// in dao.js
async function someFunc() {
    const cursor = await getCursor();
    if (cursor) {
        // do something
        cursor.continue()
    } else {
        console.log(&quot;no more data&quot;)
    }
}
```

ä¸€å¼€å§‹æˆ‘æ˜¯è¿™ä¹ˆè®¾æƒ³çš„ï¼Œä½†æ˜¯æˆ‘å‘ç°äº†ä¸€ä¸ªä»¤äººç‰¹åˆ«ç–‘æƒ‘çš„é—®é¢˜ï¼šä¸ºä»€ä¹ˆåœ¨MDNçš„æ–‡æ¡£ä¸­ï¼Œä½¿ç”¨`if...else...`æ¥éå†è¿™ä¸ªcursorå‘¢ï¼Ÿ

```js
if (cursor) {
    var listItem = document.createElement(&quot;li&quot;);
    listItem.innerHTML = cursor.value.albumTitle + &quot;, &quot; + cursor.value.year;
    list.appendChild(listItem);
    cursor.continue();
} else {
    console.log(&quot;Entries all displayed.&quot;);
}

// æ¥è‡ªMDNï¼Œå¯ä»¥çœ‹åˆ°ä½¿ç”¨ if else è¿›è¡Œéå†
```

å½“æ—¶æˆ‘ä¹Ÿæ˜¯å€Ÿé‰´MDNï¼Œä½¿ç”¨`if...else...`æ¥éå†ï¼Œä½†æ˜¯æˆ‘å‘ç°æˆ‘çš„ä»£ç åªèƒ½è¿è¡Œä¸€æ¬¡ï¼Œè¿™è‚¯å®šä¸å«éå†å•Šã€‚**è°å®¶å¥½äººç”¨`if...else`åšéå†å•Šï¼Ÿï¼Ÿï¼Ÿ** å¹´è½»äººä¸æ°”ç››èƒ½å«å¹´è½»äººå—ï¼Ÿè¿™è‚¯å®šæ˜¯MDNå†™é”™äº†ï¼æ ¹æ®æˆ‘çš„ç»éªŒï¼Œç«‹åˆ»ç»™ä»–æ”¹å†™æˆäº†è¿™æ ·ï¼š

```js
async function someFunc() {
    const cursor = await getCursor();
    // ä» if è¯­å¥å˜ä¸º while è¯­å¥
    while (cursor) {
        // çŒœçŒœä¼šè¾“å‡ºä»€ä¹ˆï¼Ÿ
        console.log(cursor.key);
        // do something
        cursor.continue()
    }
    console.log(&quot;no more data&quot;)
}
```

çœ‹èµ·æ¥æ²¡ä»€é—®é¢˜ï¼Œéå¸¸æ­£ç¡®ï¼

**ä½†æ˜¯** ï¼Œåœ¨æˆ‘å®é™…è¿è¡Œè¿™æ®µä»£ç çš„æ—¶å€™ï¼Œå¹¶ä¸èƒ½æ­£å¸¸è¿è¡Œã€‚æˆ‘ä»¬å¸Œæœ›å®ƒçš„è¾“å‡ºæ˜¯`1 2 3 4 5 ....`ï¼Œè€Œå®é™…çš„è¾“å‡ºç»“æœå´æ˜¯`1 1 1 1 1 ...`ã€‚ä¸ºå•¥ä¼šå‡ºç°è¿™ç§ç»“æœå‘¢ï¼ŸğŸ˜¥æœ¬æ¥æˆ‘ä»¥ä¸ºæ˜¯`cursor.continue()`æ–¹æ³•æ˜¯å¼‚æ­¥çš„ï¼Œä½†æ˜¯ç»“æœè¿™æ˜¯ä¸€ä¸ªå®Œå®Œå…¨å…¨çš„åŒæ­¥å‡½æ•°ã€‚æ€ä¹ˆå›äº‹å‘¢ï¼Ÿ

å¦‚æœè¯´`continue`æ–¹æ³•ä¸èµ·ä½œç”¨çš„è¯ï¼Œä½†æ˜¯å®ƒç¡®å®èƒ½å¤Ÿå¸®æˆ‘ä»¬å°†cursorå‘å‰ç§»ä½ï¼Œå¹¶åœ¨cursorç»“æŸæ—¶ç»“æŸå¾ªç¯ï¼ˆè™½ç„¶æŠ¥äº†ä¸€ä¸ªinfoï¼‰ï¼Œä½†æ˜¯å¦‚æœè¯´å®ƒèµ·ä½œç”¨çš„ï¼Œæˆ‘ä»¬çš„cursoræ¯æ¬¡éƒ½æŒ‡å‘ç¬¬ä¸€æ¡æ•°æ®ã€‚è¿™æ˜¯æ€ä¹ˆå›äº‹å‘¢ï¼Ÿï¼Ÿï¼Ÿ

éš¾é“IndexDBè¿™ä¸ªæ–¹æ³•è¿˜æœ‰bugï¼Ÿä¸å¯èƒ½å§ï¼Ÿ*éš¾é“çœŸçš„æ˜¯ä½¿ç”¨`if...else`éå†*ï¼Ÿäºæ˜¯æˆ‘å†æ¬¡æŸ¥é˜…MDNï¼Œç°åœ¨æˆ‘ä¸ºå¤§å®¶è´´ä¸ŠMDNå®Œæ•´çš„ä»£ç æ®µï¼š

```js
function displayData() {
    var transaction = db.transaction([&quot;rushAlbumList&quot;], &quot;readonly&quot;);
    var objectStore = transaction.objectStore(&quot;rushAlbumList&quot;);

    objectStore.openCursor().onsuccess = function (event) {
        var cursor = event.target.result;
        if (cursor) {
            var listItem = document.createElement(&quot;li&quot;);
            listItem.innerHTML = cursor.value.albumTitle + &quot;, &quot; + cursor.value.year;
            list.appendChild(listItem);

            cursor.continue();
        } else {
            console.log(&quot;Entries all displayed.&quot;);
        }
    };
}
```

ç»è¿‡æˆ‘çš„è§‚å¯Ÿï¼Œéš¾é“...`cursoråªèƒ½åœ¨openCursorçš„å›è°ƒä¸­ä½¿ç”¨ï¼Ÿï¼Ÿ` å¸¦ç€è¿™ä¸ªçŒœæƒ³ï¼Œæˆ‘å°†æˆ‘çš„ä»£ç æ”¹ä¸ºè¿™æ ·ï¼š

```js
if (!db) {
    return Promise.reject(&quot;database connect instance can&#39;t be null&quot;)
}
const store = db.transaction(storeName, &#39;readonly&#39;).objectStore(storeName)
const request = store.openCursor();
return new Promise((resolve, reject) =&gt; {
    request.onsuccess = (e) =&gt; {
        const res = []
        const cursor = e.target[&quot;result&quot;]
        if (cursor) {
            res.push(cursor.value)
            cursor.continue()
        } else {
            resolve(res)
        }
    }
    request.onerror = (e) =&gt; {
        reject(e)
    }
})
```

å—¯ï¼Œæœç„¶ä¸å‡ºæ‰€æ–™ï¼Œç°åœ¨æˆ‘ä»¬å·²ç»å¯ä»¥æ­£ç¡®çš„éå†cursoräº†ï¼ä½†æ˜¯åˆæœ‰ä¸€ä¸ªé—®é¢˜éšä¹‹è€Œæ¥ï¼Œä¸ºä»€ä¹ˆæ¯æ¬¡æˆ‘çš„resåªæœ‰ä¸€ä¸ªæ•°æ®ğŸ˜…ï¼Ÿç»è¿‡æˆ‘çš„ä¸€ç•ªæ€è€ƒï¼Œä¸€ä¸ªå¾ˆææ€–çš„æƒ³æ³•é—ªç°å‡ºæ¥ï¼Œæ²ƒæ—¥ï¼ŒindexDBä½ ä¸ä¼š....**æ¯æ¬¡æ¸¸æ ‡ç§»ä½éƒ½è¦è°ƒç”¨onSuccesså›è°ƒå§**ï¼Ÿ

äºæ˜¯æˆ‘ä»¬å†æ¬¡æ”¹å†™ä»£ç ï¼Œå†™æˆè¿™æ ·ï¼š

```js
if (!db) {
    return Promise.reject(&quot;database connect instance can&#39;t be null&quot;)
}
const store = db.transaction(storeName, &#39;readonly&#39;).objectStore(storeName)
const request = store.openCursor();
// å°†resæ”¾åˆ°å›è°ƒå‡½æ•°ä¹‹å¤–
const res = []
return new Promise((resolve, reject) =&gt; {
    request.onsuccess = (e) =&gt; {
        const cursor = e.target[&quot;result&quot;]
        if (cursor) {
            res.push(cursor.value)
            cursor.continue()
        } else {
            resolve(res)
        }
    }
    request.onerror = (e) =&gt; {
        reject(e)
    }
})
```

è¿™æ—¶ï¼Œæˆ‘ä»¬ç»ˆäºå¦‚æ„¿ä»¥å¿çš„æ‹¿åˆ°äº†æˆ‘ä»¬éœ€è¦çš„æ•°æ®ï¼ˆçœŸæ˜¯è¾›è‹¦å•ŠğŸ˜­ï¼‰

## æ€»ç»“

ç°åœ¨æˆ‘ä»¬æ¥æ€»ç»“ä¸€ä¸‹cursorçš„å‘ï¼š

- cursorå¿…é¡»é…åˆ`oepnCursor`å‡½æ•°çš„å›è°ƒå‡½æ•°ä¸€èµ·ä½¿ç”¨

- æ¯æ¬¡è°ƒç”¨`cursor.continue()`å¹¶ä¸æ˜¯ç®€å•çš„å°†cursorç§»ä½ï¼Œè€Œæ˜¯è¯·æ±‚IDBçš„APIæ›´æ–°cursorå¹¶å†æ¬¡è§¦å‘`openCursor`çš„å›è°ƒå‡½æ•°

æ‰€ä»¥ä¸Šé¢é‚£ä¸€ç‰ˆä»£ç å°±æ˜¯ä½¿ç”¨cursoréå†çš„æ ‡å‡†æ¨¡æ¿ï¼Œå› ä¸ºè¿™ä¸ªè¿‡ç¨‹æ˜¯ç±»ä¼¼é€’å½’çš„è¿‡ç¨‹ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„cursoræ˜¯çœŸçš„ä½¿ç”¨`if...else...`éå†ä»£ç ğŸ˜¥ï¼Œæ²¡æ¯›ç—…å“¦å…„å¼Ÿä»¬</p> </div> </div> </a>  </div><div class="card-item" data-astro-cid-p3vyftr4> <a href="/blog/technology/project/fix-wxml-cant-load-bg-img/" class="card-link" data-astro-cid-dohjnao5> <div class="card" data-astro-cid-dohjnao5> <div class="card-image" data-astro-cid-dohjnao5>  </div> <div class="card-content" data-astro-cid-dohjnao5> <h3 class="card-title" data-astro-cid-dohjnao5>ä¿®å¤å¾®ä¿¡å°ç¨‹åºçœŸæœºè°ƒè¯•æ— æ³•æ˜¾ç¤ºèƒŒæ™¯å›¾ç‰‡çš„é—®é¢˜</h3> <p class="card-description" data-astro-cid-dohjnao5># ä¿®å¤å¾®ä¿¡å°ç¨‹åºçœŸæœºè°ƒè¯•æ— æ³•æ˜¾ç¤ºèƒŒæ™¯å›¾ç‰‡çš„é—®é¢˜
è…¾è®¯å‡ºäºæŸäº›åŸå› çš„è€ƒè™‘ï¼Œä¸æ”¯æŒå¾®ä¿¡å°ç¨‹åºçš„èƒŒæ™¯å›¾ç‰‡ä¸ºæœ¬åœ°å›¾ç‰‡ï¼Œ æ‰€ä»¥è¿™å°±è¦æ±‚æˆ‘ä»¬æŠŠå›¾ç‰‡å­˜æ”¾åœ¨æœåŠ¡å™¨ä¸­ã€‚
å¦‚æœä½ æ˜¯äº‘å¼€å‘é¡¹ç›®å°†ï¼Œå¯ä»¥å°†å›¾ç‰‡æ”¾åœ¨è…¾è®¯çš„äº‘æœåŠ¡å™¨ä¸Šï¼Œå…·ä½“æ“ä½œå¦‚å›¾ï¼š
![å…ˆç‚¹å‡»äº‘å¼€å‘æ§åˆ¶å°](../../essay/prose/imperial_edict/img1.png)
![ä¸Šä¼ å›¾ç‰‡](../framework/fluid-tags-bug-fix/img2.png)
![å°†å›¾ç‰‡çš„æœ¬åœ°urlè½¬åŒ–ä¸ºç½‘ç»œèµ„æºçš„url](../framework/fluid-tags-bug-fix/img3.png)
æ³¨æ„ï¼šå› ä¸ºå­˜æ”¾åœ¨äº‘æœåŠ¡å™¨ä¸Šï¼ŒåŠ è½½å¯èƒ½ä¼šç¨æ…¢</p> </div> </div> </a>  </div><div class="card-item" data-astro-cid-p3vyftr4> <a href="/blog/technology/program/to-do-list-by-nodejs/" class="card-link" data-astro-cid-dohjnao5> <div class="card" data-astro-cid-dohjnao5> <div class="card-image" data-astro-cid-dohjnao5>  </div> <div class="card-content" data-astro-cid-dohjnao5> <h3 class="card-title" data-astro-cid-dohjnao5>ä½¿ç”¨node.jsåˆ›å»ºä¸€ä¸ªtodoåˆ—è¡¨â€”â€”node.jsæœåŠ¡å™¨æ­å»ºã€jsonè¯»å†™ä»¥åŠä½¿ç”¨pm2ä¿æŒæœåŠ¡è¿è¡Œ</h3> <p class="card-description" data-astro-cid-dohjnao5># ä½¿ç”¨node.jsåˆ›å»ºä¸€ä¸ªtodoåˆ—è¡¨â€”â€”node.jsæœåŠ¡å™¨æ­å»ºä»¥åŠjsonè¯»å†™

## å‰è¨€

å‰äº›æ—¥å­å­¦ä¹ äº† nodejs ï¼Œé¡ºç†æˆç« çš„æƒ³è¦æ‰¾ç‚¹ä¸œè¥¿ç»ƒç»ƒæ‰‹ã€‚æ°å¥½æœ€è¿‘éœ€è¦ä¸€ä¸ªç®€ä»‹çš„todo listç½‘é¡µï¼Œå› ä¸ºä¹‹å‰ç”¨çš„ä¸€äº›todo liståº”ç”¨éƒ½è¢«å¢™äº†ï¼Œè®¿é—®é€Ÿåº¦æ„Ÿäººï¼Œäºæ˜¯å°±æƒ³è‡ªå·±æä¸€ä¸ªtodoã€‚

è€Œæ°å¥½ï¼Œæˆ‘è¦æçš„todoæ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„ç¨‹åºï¼Œéå¸¸é€‚åˆç”¨nodejsè¿™æ ·çš„è§£é‡Šå‹è„šæœ¬è¯­è¨€æ¥å®ç°ï¼Œæ¯”èµ·javaè¿™æ ·å…‰æ­æ¡†æ¶å°±è¦åŠå¤©çš„ä¸“æ³¨å¤§å‹é¡¹ç›®çš„è¯­è¨€ï¼Œnodejs çš„ä¼˜åŠ¿å°±æ˜¯éæ˜æ˜¾äº†ã€‚
&lt;!-- more --&gt;

nodejsæ­å»ºæœåŠ¡å™¨åªéœ€è¦å»nodejså®˜ç½‘å¤åˆ¶è¿™æ ·çš„ä¸€å—ä»£ç ï¼š

```javascript
const express = require(&#39;express&#39;)
const app = express()

app.get(&#39;/&#39;, (req, res) =&gt; {
  res.send(&#39;Hi!&#39;)
})

app.listen(3000, () =&gt; console.log(&#39;Server ready&#39;))
```

æ‰€ä»¥æˆ‘ä»¬å¯ä»¥æŠŠæ›´å¤šçš„ç»å†æ”¾åœ¨æˆ‘ä»¬çš„ä¸šåŠ¡å®ç°ä¸Šã€‚

## å‡†å¤‡å·¥ä½œ

### éœ€æ±‚åˆ†æ

åœ¨å¼€å§‹åŠ¨å·¥ä¹‹å‰ï¼Œè¦å…ˆåˆ—å‡ºéœ€æ±‚ã€‚å½“æ—¶æˆ‘çš„éœ€æ±‚å¦‚ä¸‹ï¼š

- æ·»åŠ éœ€è¦åšçš„äº‹æƒ…

- å±•ç¤ºéœ€è¦åšçš„äº‹æƒ…

- å®Œæˆéœ€è¦åšçš„äº‹æƒ…

- æŸ¥çœ‹æ›¾ç»å®Œæˆçš„äº‹æƒ…

### è§£å†³æ–¹æ¡ˆåˆ†æ

å¯¹äºä¸Šè¿°éœ€æ±‚ï¼Œæˆ‘æ‰“ç®—è¿™æ ·å®ç°ï¼š

- ä½¿ç”¨jsonæ–‡ä»¶ç³»ç»Ÿå®ç°æŒä¹…åŒ–æ“ä½œ

- ä½¿ç”¨nodejsæ¥è·å–æ•°æ®

- ä½¿ç”¨nodejsæ¥å¤„ç†æ•°æ®å¹¶å‚¨å­˜æ•°æ®

è¿™æ ·çš„è¯ã€‚æ˜ç¡®äº†éœ€æ±‚ä¸å®ç°æ–¹å¼ï¼Œæˆ‘ä»¬å°±å¯ä»¥åŠ¨å·¥äº†ã€‚

## å®ç°

### jsonè¯»å†™

nodejsæä¾›äº†ä¸€å¥—æ–‡ä»¶çš„è¯»å†™çš„æ¨¡å—ï¼š`fs`ã€‚ä½¿ç”¨fså¯ä»¥å¾ˆç®€å•çš„å®ç°æ–‡æœ¬æ–‡ä»¶çš„è¯»å†™ã€‚ä½†æ˜¯ä¸ºäº†æˆ‘ä»¬åœ¨å¼€å‘çš„æ—¶å€™æ›´åŠ æ–¹ä¾¿ï¼Œæˆ‘åˆå°†ä»–å°è£…æˆäº†ä¸€ä¸ªä¸“æ³¨jsonè¯»å†™çš„æ–¹æ³•ï¼š

```javascript
//in jsonHandler.js
const fs = require(&quot;fs&quot;);

function test(){
    console.log(&quot;Hello world!&quot;)
}
function readJson(name){
    let jsonFile = fs.readFileSync(&quot;./&quot;+name);
    let toDoList = JSON.parse(jsonFile);    //è§£æjsonï¼Œå¹¶ç›´æ¥è¿”å›jsonå¯¹è±¡
    return toDoList;
}
function writeJson(name,data){
    fs.writeFileSync(&quot;./&quot;+name,JSON.stringify(data));
}

module.exports = {
    readJson,
    writeJson
}
```

### æœåŠ¡å™¨æ­å»º

è¿˜è®°å¾—æˆ‘ä»¬çš„æœåŠ¡å™¨çš„æ ¼å¼å—ï¼Ÿæˆ‘ä»¬å…ˆå®šä¹‰ä¸€ä¸‹æˆ‘ä»¬çš„æœåŠ¡å™¨æ¥å£ï¼š

```javascript
//in index.js
const jh = require(&quot;./jsonHandler&quot;)
const http = require(&#39;http&#39;);
const url = require(&#39;url&#39;);
const util = require(&#39;util&#39;);

let workList = jh.readJson(&quot;list.json&quot;);

const port = 3000

const server = http.createServer((req, res) =&gt; {
    //è®¾ç½®å“åº”å¤´ä¸è¯·æ±‚ç¼–ç 
    res.statusCode = 200
    //è®¾ç½®å­—èŠ‚æµç¼–ç ä¸ºutf-8
    res.setHeader(&#39;Content-Type&#39;, &#39;text/plain;charset=utf8&#39;)
    //è®¾ç½®å…è®¸è·¨åŸŸ
    res.setHeader(&#39;Access-Control-Allow-Origin&#39;,&#39;*&#39;)
    req.setEncoding(&#39;utf8&#39;);

    //write your code here

    let ret=&quot;&quot;;    //è¿™æ˜¯éœ€è¦è¿”å›çš„æ•°æ®
    res.end(ret)
})

server.listen(port, () =&gt; {
})
```

ç„¶åæ ¹æ®æˆ‘ä»¬çš„éœ€æ±‚åˆ†æï¼Œå…ˆæ¥ç¡®å®šä»¥ä¸‹APIæ¥å£ï¼š

- `addWork()`:ç”¨æ¥æ·»åŠ ä¸€ä¸ªä»»åŠ¡å¹¶å°†æ•°æ®ä¿å­˜åˆ°json

- `deleteWord(res)`:ç”¨æ¥å°†ä¸€ä¸ªä»»åŠ¡åˆ é™¤å¹¶å°†æ•°æ®ä¿å­˜åˆ°json

- `writeHistory(work)`:å°†å®Œæˆçš„ä»»åŠ¡æ·»åŠ åˆ°å†å²è®°å½•ä¸­

- `getAllWork()`:è·å–ç›®å‰æ­£åœ¨è¿è¡Œä¸­çš„ä»»åŠ¡

é¦–å…ˆæˆ‘ä»¬å…ˆå¼€å§‹addWork()çš„ç¼–å†™ï¼Œè¦æ·»åŠ çš„è¯ï¼Œé¦–å…ˆè¦æ¥å—å¹¶è§£æå®¢æˆ·ç«¯å‘é€çš„è¯·æ±‚ï¼Œç„¶åå†å‚¨å­˜åˆ°jsonä¸­ï¼Œä»£ç å¦‚ä¸‹ï¼š

```javascript
//ç”¨æ¥å¢åŠ ä¸€ä¸ªä»»åŠ¡
    function addWork(){
        let work=&quot;&quot;;
        req.on(&#39;data&#39;, chunk =&gt; {    //æ¥å—å®¢æˆ·ç«¯å‘é€çš„è¯·æ±‚æµ
            //è¿™é‡Œè¦å–å­ä¸²çš„åŸå› æ˜¯è¯·æ±‚ä¼šå¸¦keyï¼Œæˆ‘è¿™é‡Œæ˜¯work=xxxï¼Œæ‰€ä»¥è¦å°†&#39;work=&#39;å»æ‰
            work=chunk.toString().substring(5);
            //è®¾ç½®ç¼–ç ï¼Œä¸ç„¶ä¸­æ–‡ä¼šä¹±ç 
            work = decodeURIComponent(work);
            //è§£æworklist
            let jsonObj=eval(workList)
            jsonObj.push({&quot;work&quot;:work})
            //å°†æ•°æ®å†™å›
            jh.writeJson(&quot;list.json&quot;,jsonObj)
        })
    }
```

ä»»åŠ¡å†å²ä¸æ·»åŠ ä»»åŠ¡å‡ ä¹åŒç†ï¼Œåªä¸è¿‡è¿™ä¸ªæ–¹æ³•è·å–çš„æ•°æ®æ˜¯deleteWorkæä¾›çš„ï¼Œæˆ‘ä»¬ä¸éœ€è¦å†å»ç›‘æ§å®¢æˆ·ç«¯çš„è¯·æ±‚ã€‚ä»£ç å¦‚ä¸‹ï¼š

```javascript
//ä»»åŠ¡å†å²
    function writeHistory(work) {
        let jsonStr = jh.readJson(&quot;history.json&quot;);
        let jsonObj = eval(jsonStr);
        let event = {}
        event.work = work;
        event.finishTime =new Date();
        jsonObj.push(event);
        jh.writeJson(&quot;history.json&quot;,jsonObj)
    }
```

åˆ é™¤ä»»åŠ¡ä¹Ÿæ˜¯åŒç†ï¼Œæˆ‘ä»¬è¦åœ¨å‰ç«¯ç»™æ¯ä¸ªä»»åŠ¡éšæ€§çš„æ ‡ä¸Šindexï¼Œç„¶åå°±å¯ä»¥ç”¨æ¥åˆ é™¤äº†ï¼š

```javascript
//åˆ é™¤ä»»åŠ¡
    function deleteWork(res){
        req.on(&#39;data&#39;, chunk =&gt; {
            console.log(`å¯ç”¨çš„æ•°æ®å—: ${chunk}`)
            //è·å–ç‚¹å‡»äº‹ä»¶çš„ä½ç½®
            let index=chunk.toString().substring(3);
            let jsonObj=eval(workList)
            //æ·»åŠ å†å²
            let work = jsonObj[index].work
            writeHistory(work)
            //åˆ é™¤
            jsonObj.splice(index,1);
            // console.log(jsonObj)
            jh.writeJson(&quot;list.json&quot;,jsonObj)
        })
    }
```

è·å–ä»»åŠ¡å°±éå¸¸ç®€å•äº†ï¼Œæˆ‘ä»¬åªéœ€è¦ä»jsonä¸­æ‹¿åˆ°æ•°æ®å¹¶è½¬å‘ç»™å®¢æˆ·ç«¯å°±å¯ä»¥äº†ï¼š

```javascript
//è·å–æ‰€æœ‰ä»»åŠ¡
    function getAllWork(){
        workList=jh.readJson(&quot;list.json&quot;);
        ret=JSON.stringify(workList);
    }
```

æœ€åå‘¢ï¼Œæˆ‘ä»¬éœ€è¦å†™ä¸€ä¸ªè·¯ç”±è§£æï¼Œå› ä¸ºjséå¸¸å°ï¼Œæ‰€ä»¥è¿™äº›ä¸œè¥¿éƒ½å†™åœ¨ä¸€ä¸ªæ–‡ä»¶é‡Œé¢å°±å¯ä»¥ï¼š

```javascript
/è§£æè·¯ç”±
    let pathname = url.parse(req.url).pathname;
    //è·¯ç”±é…ç½®
    if (pathname===&quot;/getAllWork&quot;){
        getAllWork()
    }
    else if(pathname===&quot;/addWork&quot;){
        addWork()
    }
    else if(pathname===&quot;/deleteWork&quot;){
        deleteWork()
    }
```



éšä¸‹è´´å‡ºå‰ç«¯æºç ï¼š

```html
&lt;-- in index.html --&gt;
&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;ch&quot;&gt;
&lt;head&gt;
    &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;https://cdn.simplecss.org/simple.css&quot;&gt;
    &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;technological.css&quot;&gt;
    &lt;meta charset=&quot;UTF-8&quot;&gt;
    &lt;title&gt;Title&lt;/title&gt;
    &lt;script src=&quot;https://cdn.staticfile.org/jquery/1.10.2/jquery.min.js&quot;&gt;&lt;/script&gt;
&lt;/head&gt;
&lt;body class=&quot;tech-background&quot; style=&quot;text-align: center&quot;&gt;
    &lt;p&gt; wish you a substantial day&lt;/p&gt;
    &lt;p&gt;to do list&lt;/p&gt;
    &lt;label&gt;
        &lt;input name=&quot;add-work&quot; id=&quot;add-work&quot; class=&quot;tech-input&quot; style=&quot;width: 70%&quot;&gt;
        &lt;button onclick=&#39;addWork()&#39; class=&quot;tech-btn&quot; style=&quot;display: inline;&quot;&gt;å¢åŠ &lt;/button&gt;
    &lt;/label&gt;
    &lt;div id=&quot;container&quot;&gt;&lt;/div&gt;
    &lt;script&gt;
        &#39;use strict&#39;
        $.ajax({
            url:&quot;http://localhost:3000/getAllWork&quot;,
            method:&quot;GET&quot;,
            crossDomain: true,
            success:(res)=&gt;{
                let con=document.getElementById(&quot;container&quot;);
                let workList=JSON.parse(res)
                console.log(workList)
                workList=eval(workList)
                for (let i=0;i&lt;workList.length;i++){
                    let list=document.createElement(&quot;label&quot;);
                    list.innerHTML=&quot;&lt;input name=\&quot;work-list\&quot; id=\&quot;work&quot;+i+&quot;\&quot; value=&#39;&quot;+workList[i].work+&quot;&#39; class=&#39;tech-input&#39; style=\&quot;width: 70%\&quot;&gt; &quot; +
                        &quot;&lt;button onclick=&#39;deleteWork(this)&#39; id=&#39;&quot;+i+&quot;&#39; class=&#39;tech-btn&#39; style=\&quot;display: inline;\&quot;&gt;å®Œæˆ&lt;/button&gt;&quot;;
                    con.appendChild(list);
                }
            }
        })
        function addWork(){
            let work=document.getElementById(&quot;add-work&quot;).value;
            $.ajax({
                url: &quot;http://localhost:3000/addWork&quot;,
                method: &quot;POST&quot;,
                crossDomain: true,
                data:{
                    &quot;work&quot;:work
                },
                success:(res)=&gt;{
                    // alert(&quot;success&quot;);
                    location.reload();
                }
            })
        }
        function deleteWork(res){
            let index=res.id;
            $.ajax({
                url: &quot;http://localhost:3000/deleteWork&quot;,
                method: &quot;POST&quot;,
                crossDomain: true,
                data:{
                    &quot;id&quot;:index
                },
                success:(res)=&gt;{
                    // alert(&quot;success&quot;);
                    location.reload();
                }
            })
        }
    &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
```



è¿™ä¸ªé¡¹ç›®çš„æºç æˆ‘ä¹Ÿä¼šæ”¾åœ¨GitHubï¼ˆå› ä¸ºé¡¹ç›®å®åœ¨å¤ªå°æˆ‘ç”šè‡³éƒ½æ²¡æœ‰å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ï¼‰

[é¡¹ç›®åœ°å€](https://github.com/charlesix59/todo_list_by_nodeJS)

## ä¿æŒä»£ç è¿è¡Œ

æˆ‘ä»¬æœåŠ¡å™¨ä»£ç å½“ç„¶è¦æœ‰ä¸€ä¸ªæœåŠ¡å™¨å»è¿è¡Œï¼Œè€Œè¿™ä¸ªè¿·ä½ çš„é¡¹ç›®æ˜¾ç„¶ä¸å€¼å¾—è®©æˆ‘ä»¬å»åˆ†é…ä»–ä¸€ä¸ªäº‘æœåŠ¡å™¨åŠ ä¸€ä¸ªåŸŸåï¼Œé‚£ä¹ˆæˆ‘ä»¬æ˜¯å¦å¯ä»¥æŠŠè¿™ä¸ªæœåŠ¡è¿è¡Œåœ¨æœ¬åœ°å‘¢ï¼Ÿ

å¯æ˜¯è¿è¡Œåœ¨æœ¬åœ°å°±éœ€è¦é¢‘ç¹çš„é‡å¯æœåŠ¡ï¼Œæ¯æ¬¡å¼€æœºéƒ½è¦å¯åŠ¨ä¸€æ¬¡ï¼Œè¿™æœªå…ä¹Ÿå¤ªéº»çƒ¦äº†ã€‚äºæ˜¯æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨**pm2**æ¥ä½¿æˆ‘ä»¬çš„é¡¹ç›®ä¿æŒè¿è¡Œ

å…³äºpm2æˆ‘åœ¨æ­¤ä¸å¤šèµ˜è¿°äº†ï¼Œå¤§å®¶æœ‰å…´è¶£çš„å¯ä»¥è‡ªè¡Œç™¾åº¦æœç´¢ï¼Œæˆ‘åªç»™å‡ºéƒ¨ç½²çš„å‘½ä»¤ï¼š

```shell
npm install pm2 -g #å…¨å±€å®‰è£…pm2
cd &lt;é¡¹ç›®ç›®å½•&gt;
pm2 start index.js --watch
pm2 save
pm2 list
```

å¦‚æœä½ éƒ¨ç½²æˆåŠŸï¼Œé‚£ä¹ˆå½“ä½ è¿è¡Œ`pm2 list`ä¹‹åä½ å°±å¯ä»¥çœ‹åˆ°ä½ çš„é¡¹ç›®äº†</p> </div> </div> </a>  </div><div class="card-item" data-astro-cid-p3vyftr4> <a href="/blog/technology/css/flex_active_warp/" class="card-link" data-astro-cid-dohjnao5> <div class="card" data-astro-cid-dohjnao5> <div class="card-image" data-astro-cid-dohjnao5>  </div> <div class="card-content" data-astro-cid-dohjnao5> <h3 class="card-title" data-astro-cid-dohjnao5>flex-directionä¸ºrowæ—¶ä¸»åŠ¨æ¢è¡Œ</h3> <p class="card-description" data-astro-cid-dohjnao5># flex-directionä¸ºrowæ—¶ä¸»åŠ¨æ¢è¡Œ(React nativeä¸»åŠ¨æ¢è¡Œ)

æˆ‘ä»Šå¤©åœ¨å†™`react-native`æ—¶å€™ï¼Œé‡åˆ°äº†å¾ˆä¸èˆ’æœçš„ä¸€ä»¶äº‹æƒ…ã€‚å› ä¸ºRNé»˜è®¤æ˜¯`flex`å¸ƒå±€ï¼Œæ‰€ä»¥å¦‚æœæˆ‘æƒ³è¦å®ç°`inline`æ¨¡å¼å°±åªèƒ½è®¾ç½®çˆ¶å…ƒç´ çš„`flex-direction`çš„valueä¸º`row`ã€‚è¿™æ ·å¦‚æœæˆ‘ä»¬å¦‚æœæƒ³è¦æ¢è¡Œéœ€è¦æ€ä¹ˆå¤„ç†å‘¢ï¼Ÿ

è¦çŸ¥é“ï¼Œåœ¨RNä¸­æ˜¯æ²¡æœ‰`&lt;br&gt;`æ ‡ç­¾çš„ï¼Œæ‰€ä»¥è¦æƒ³æ¢è¡Œéœ€è¦é‡‡å–ä¸€äº›éå¸¸çš„æ‰‹æ®µã€‚

é‚£æœ‰æ²¡æœ‰ä»€ä¹ˆå¥½åŠæ³•èƒ½å¤Ÿåšåˆ°ä¸»åŠ¨æ¢è¡Œå‘¢ï¼Ÿ

åœ¨æ­£å¼å¼€å§‹ä¹‹å‰æˆ‘å…ˆä¸Šä¸€ä¸ªä¾‹å­ï¼š

```jsx
const arr = [1, 2, 3, 4, 5, 6];

export default function App() {
  return (
    &lt;SafeAreaView style={styles.container}&gt;
      &lt;View style={{ flexDirection: &#39;row&#39; }}&gt;
        {arr.map((item, index) =&gt; (
          &lt;View&gt;
            &lt;Text key={index}&gt;{item}&lt;/Text&gt;
          &lt;/View&gt;
        ))}
      &lt;/View&gt;
    &lt;/SafeAreaView&gt;
  );
}
```

å¾ˆæ˜æ˜¾ï¼Œä¸Šè¿°çš„ä»£ç ä¼šç”Ÿæˆä¸€ä¸ªçºµå‘æ’åˆ—çš„`123456`ï¼Œå¦‚æœæˆ‘ä»¬å¸Œæœ›åœ¨**æ¯ä¸‰ä¸ªæ–­ä¸€ä¸‹**ï¼Œå³å°†çºµå‘çš„`123456`æ”¹æˆæ¨ªå‘çš„`123 &lt;br&gt; 456`åº”è¯¥å¦‚ä½•åšå‘¢ï¼Ÿ

åˆšå¼€å§‹çš„æ—¶å€™æˆ‘é—®äº†ChatGPTï¼Œä»–ç»™å‡ºçš„ç­”æ¡ˆæ˜¯ä½¿ç”¨ä¼ªç±»æ’‘å¼€å…ƒç´ ï¼š

```html
&lt;div class=&quot;flex-container&quot;&gt;
  &lt;div class=&quot;flex-item&quot;&gt;1&lt;/div&gt;
  &lt;div class=&quot;flex-item break-after&quot;&gt;2&lt;/div&gt; &lt;!-- æƒ³è¦åœ¨è¿™ä¸ªå…ƒç´ åæ¢è¡Œ --&gt;
  &lt;div class=&quot;flex-item&quot;&gt;3&lt;/div&gt;
  &lt;div class=&quot;flex-item&quot;&gt;4&lt;/div&gt;
&lt;/div&gt;
```

```css
.flex-container {
  display: flex;
  flex-wrap: wrap;
  flex-direction: row;
}

.flex-item {
  width: 100px;
  margin: 5px;
}

.break-after::after {
  content: &quot;&quot;;
  flex-basis: 100%;
}
```

ç»è¿‡æˆ‘çš„å°è¯•ï¼Œè¿™ç§æ–¹æ³•å¾ˆé—æ†¾çš„ä¸èµ·ä»»ä½•ä½œç”¨ï¼Œè€Œä¸”åœ¨RNä¸­ä½¿ç”¨CSS classå¹¶ä¸æ˜¯å¾ˆå®¹æ˜“ã€‚ä½†æ˜¯ä»–ç»™å‡ºçš„ä»£ç ç¡®å®ç»™äº†æˆ‘ä¸€äº›å¯å‘ï¼Œç»è¿‡ä¸€äº›æ‘¸ç´¢ï¼Œæˆ‘å‘ç°**å¦‚æœä¸€æ¬¡æ¸²æŸ“ä¸¤ä¸ªå…ƒç´ ï¼Œå…¶ä¸­ä¸€ä¸ªæ˜¯æ­£å¸¸å…ƒç´ è€Œå¦ä¸€ä¸ªè´Ÿè´£æ’‘å¼€å…ƒç´ **ï¼Œé‚£ä¹ˆå°±å¯ä»¥å®ç°æ¢è¡Œï¼Œä»£ç å¦‚ä¸‹ï¼š

```jsx
const arr = [1, 2, 3, 4, 5, 6];

export default function App() {
  return (
    &lt;SafeAreaView style={styles.container}&gt;
      &lt;View style={{ flexDirection: &#39;row&#39;, flexWrap: &#39;wrap&#39;, width: 200 }}&gt;
        {arr.map((item, index) =&gt; {
          if (item % 3 !== 0) {
            return &lt;Text key={index}&gt;{item}&lt;/Text&gt;;
          } else {
            return (
              &lt;&gt;
                {[
                  &lt;Text key={index}&gt;{item}&lt;/Text&gt;,
                  &lt;View style={{ width: &#39;100%&#39; }}&gt;&lt;/View&gt;,
                ]}
              &lt;/&gt;
            );
          }
        })}
      &lt;/View&gt;
    &lt;/SafeAreaView&gt;
  );
}
```

ä½†æ˜¯å¾ˆæŠ±æ­‰ï¼Œè¿™æ ·ä¾æ—§æœ‰ç¼ºé™·ï¼Œå› ä¸ºreactNativeä¸­`&lt;&gt;&lt;/&gt;`å®é™…ä¸Šä¼šå½±å“ç»§æ‰¿ï¼Œå³Textå’ŒViewå°†ä¼šè¢«çœ‹ä½œä¸€ä¸ªæ•´ä½“ï¼Œè€Œä¸ä¼šè¢«è§£ææˆä¸¤ä¸ªå•ç‹¬çš„å…ƒç´ ï¼Œ**å¹¶ä¸”`return`ä¸­çš„`jsx fragment`å¿…é¡»æœ‰ä¸€ä¸ªæ ¹èŠ‚ç‚¹**ï¼Œä¹Ÿå°±è¯´è¯´è¿™ç§æ–¹æ³•ä¸é¡¶ä¸ŠcharGPTç»™å‡ºçš„æ–¹æ³•å¹¶æ²¡æœ‰åŒºåˆ«ï¼Œéƒ½æ— æ³•å°†ä¸€ä¸ªå…ƒç´ å®Œç¾æ¢è¡Œã€‚è¿™åªä¼šè®©æˆ‘ä»¬éœ€è¦æ¢è¡Œçš„å…ƒç´ å˜ä¸ºå•ç‹¬çš„ä¸€è¡Œè€Œå·²ã€‚

é‚£ä¹ˆï¼Œè¿˜æœ‰ä»€ä¹ˆæ–¹æ³•å‘¢ï¼Ÿ

## å®Œç¾çš„æ¢è¡Œ

è¿™æ—¶å€™æˆ‘ä»¬æˆ–è®¸éœ€è¦æ›´æ–°ä¸€ä¸‹æ€è·¯ï¼Œå¦‚æœåœ¨æ¸²æŸ“è¿‡ç¨‹ä¸­æ— æ³•åšåˆ°å®Œç¾çš„æ¢è¡Œï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¸ºä»€ä¹ˆä¸èƒ½åœ¨æ•°æ®ä¸ŠåŠ¨ä¸€ç‚¹æ‰‹è„šå‘¢ï¼Ÿç»è¿‡ä¸€ç³»åˆ—æ€è·¯çš„è½¬æ¢ï¼Œæˆ‘çªç„¶æƒ³åˆ°æˆ‘ä»¬å®Œå…¨å¯ä»¥**è¿›è¡Œä¸€ä¸ªæ•°ç»„åˆ†å‰²+å…ƒç´ åµŒå¥—çš„æ–¹å¼å®ç°æ¢è¡Œ**ï¼Œä»£ç å¦‚ä¸‹ï¼š

```jsx
const arr = [1, 2, 3, 4, 5, 6];
export default function App() {
  const [arrState, setArrState] = useState([]);
  useEffect(() =&gt; {
    const result = [];
    let tempArr = [];
    arr.forEach((item) =&gt; {
      tempArr.push(item);
      if (item % 3 === 0) {
        result.push(tempArr);
        tempArr = [];
      }
    });
    setArrState(result);
  }, []);
  return (
    &lt;SafeAreaView style={styles.container}&gt;
      {arrState.map((subArr, index) =&gt; (
        &lt;View
          key={index}
          style={{ flexDirection: &#39;row&#39;, flexWrap: &#39;wrap&#39;, width: 200 }}&gt;
          {subArr.map((item, subIndex) =&gt; {
            return &lt;Text key={subIndex}&gt;{item}&lt;/Text&gt;;
          })}
        &lt;/View&gt;
      ))}
    &lt;/SafeAreaView&gt;
  );
}
```

ç»ˆäºï¼Œæˆ‘ä»¬å®ç°äº†å®Œç¾çš„æ¢è¡Œï¼

soï¼Œå¦‚æœä½ ä¹Ÿæƒ³è¦åœ¨flexå¸ƒå±€ä¸­å°è¯•ä¸»åŠ¨æ¢è¡Œï¼Œé‚£ä¹ˆå¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½å¤Ÿè§£ç­”ä½ çš„ç–‘æƒ‘ã€‚

å½“ç„¶ï¼Œå¦‚æœä½ æœ‰æ›´å¥½çš„æ–¹æ³•ï¼Œéå¸¸å¸Œæœ›èƒ½åœ¨ä¸‹æ–¹è¯„è®ºåŒºå’Œæˆ‘åˆ†äº«ä½ çš„å¥½ä¸»æ„ğŸ¤—</p> </div> </div> </a>  </div><div class="card-item" data-astro-cid-p3vyftr4> <a href="/blog/technology/react/react_node/" class="card-link" data-astro-cid-dohjnao5> <div class="card" data-astro-cid-dohjnao5> <div class="card-image" data-astro-cid-dohjnao5>  </div> <div class="card-content" data-astro-cid-dohjnao5> <h3 class="card-title" data-astro-cid-dohjnao5>å¦‚ä½•åœ¨ react è¡¨è¾¾å¼ä¸­ä¼ å…¥ react node[] (èŠ‚ç‚¹æ•°ç»„)</h3> <p class="card-description" data-astro-cid-dohjnao5># å¦‚ä½•åœ¨ react è¡¨è¾¾å¼ä¸­ä¼ å…¥ react node[] (èŠ‚ç‚¹æ•°ç»„)

æˆ‘ä»¬çŸ¥é“ jsx è¡¨è¾¾å¼å…è®¸æ’å…¥`reactNode`ä»¥åŠ`ReactNode[]`ï¼Œå½“ä½†æˆ‘ä»¬ä¼ å…¥ä¸€ä¸ªç±»ä¼¼çš„ä¸œè¥¿çš„æ—¶å€™ä»–å´ä¼šæŠ¥é”™ï¼š

```jsx
&lt;div className=&#39;App&#39;&gt;
  {
    &lt;p&gt;aaa&lt;/p&gt;
    &lt;p&gt;bbb&lt;/p&gt; // âŒ JSX expressions must have one parent element
  }
&lt;/div&gt;
```

ä½†æ˜¯æˆ‘ä»¬æ˜æ˜å¯ä»¥ä½¿ç”¨ map å‡½æ•°ä¼ å…¥æ•°ç»„å‘€ï¼

```jsx
&lt;div className=&quot;App&quot;&gt;
  {arr.map((num) =&gt; (
    &lt;p key={num}&gt;{num}&lt;/p&gt;
  ))}
&lt;/div&gt;
```

å¦‚æœæˆ‘ä»¬å¸Œæœ›æ‰‹åŠ¨åœ¨è¡¨è¾¾å¼ä¸­ä¼ å…¥ä¸€ä¸ªèŠ‚ç‚¹æ•°ç»„æˆ‘ä»¬åº”è¯¥æ€ä¹ˆåšå‘¢ï¼Ÿå½“æˆ‘é‡åˆ°è¿™ç§å¥‡è‘©é—®é¢˜çš„æ—¶å€™æˆ‘ä¹Ÿæ˜¯æ„£äº†ä¸€ä¼šçš„ï¼Œç»è¿‡æˆ‘å¯¹`Array.map()`æ–¹æ³•çš„è§‚å¯Ÿï¼Œæˆ‘çªç„¶é¡¿æ‚Ÿï¼Œå¦‚æœæƒ³è¦æ‰‹åŠ¨ä¼ å…¥ä¸€ä¸ªèŠ‚ç‚¹æ•°ç»„åº”è¯¥è¿™ä¹ˆå†™ï¼š

```jsx
&lt;div className=&quot;App&quot;&gt;{[&lt;p&gt;aaa&lt;/p&gt;, &lt;p&gt;bbb&lt;/p&gt;]}&lt;/div&gt;
```

ä½†æ˜¯å›å¤´æƒ³æƒ³è¿™ä¸ªé—®é¢˜å¥‡æ€ªçš„å¾ˆï¼Œæˆ‘ä»¬æ˜æ˜å¯ä»¥å†™æˆï¼š

```jsx
&lt;div className=&quot;App&quot;&gt;
  &lt;p&gt;aaa&lt;/p&gt;
  &lt;p&gt;bbb&lt;/p&gt;
&lt;/div&gt;
```

ä½†æ˜¯å…¶å®æœ‰æ—¶å€™æˆ‘ä»¬çœŸçš„ä¼šéœ€è¦æ‰‹åŠ¨çš„ä¼ å…¥ä¸€ä¸ª`node[]`ï¼Œæ¯”å¦‚æœ‰äº›ç»„ä»¶å¯èƒ½åªæ¥å—ä¸€ä¸ªèŠ‚ç‚¹æ•°ç»„è€Œä½ åˆåªæœ‰æœ‰é™ä¸ªèŠ‚ç‚¹ä¸å¸Œæœ›ä½¿ç”¨`map()`ï¼Œæˆ–è€…æ˜¯è°ƒè¯•æ—¶å€™ä½¿ç”¨ï¼Œå†æˆ–è€…æ˜¯å¸Œæœ›åœ¨æ¸²æŸ“åˆ—è¡¨ä¸­åŠ å…¥å‡ ä¸ªä¸ä¹‹å‰çš„èŠ‚ç‚¹ç»“æ„ä¸åŒçš„èŠ‚ç‚¹ï¼Œæ¯”å¦‚ä»¥ä¸‹è¿™ä¸ªå®ä¾‹ï¼š

```jsx
&lt;div className=&quot;App&quot;&gt;
  {arr.map((num) =&gt; &lt;p key={num}&gt;{num}&lt;/p&gt;)
    .concat([&lt;p&gt;aaa&lt;/p&gt;, &lt;p&gt;bbb&lt;/p&gt;])}
&lt;/div&gt;
```

ä»¥ä¸Šå°±æ˜¯å¦‚ä½•ä½¿ç”¨`reactNode[]`çš„ä¸€ç‚¹ä¸ªäººå¿ƒå¾—å’¯</p> </div> </div> </a>  </div><div class="card-item" data-astro-cid-p3vyftr4> <a href="/blog/technology/react/use_effect/" class="card-link" data-astro-cid-dohjnao5> <div class="card" data-astro-cid-dohjnao5> <div class="card-image" data-astro-cid-dohjnao5>  </div> <div class="card-content" data-astro-cid-dohjnao5> <h3 class="card-title" data-astro-cid-dohjnao5>å…¨é¢ç†è§£useEffectâ€”â€”useEffectç”¨æ³•è§£æä¸ä½¿ç”¨æŠ€å·§</h3> <p class="card-description" data-astro-cid-dohjnao5># å…¨é¢ç†è§£useEffect

`useEffect`å¯ä»¥è¯´æ˜¯reactçš„hookä¸­æœ€å¼ºå¤§çš„ä¸€ä¸ªï¼Œä»–èƒ½å¤Ÿä»¥ä¸€ç§æä¸ºä¼˜é›…çš„æ–¹å¼æ¨¡æ‹Ÿæˆ‘ä»¬çš„ç”Ÿå‘½å‘¨æœŸã€‚ä½†æ˜¯ä¼˜é›…çš„ä»£ä»·å°±æ˜¯è¿™ä¸ªhookæå…¶çš„æ™¦æ¶©ï¼Œä¸å®¹æ˜“è¢«ç†è§£ä¸æŒæ¡ã€‚ä¸‹é¢æˆ‘ä»¬å°±æ¥å…¨æ–¹ä½çš„æ¢è®¨ä¸€ä¸‹ï¼Œ`useEffect`åˆ°åº•æ€ä¹ˆç”¨

## useEffectçš„ç»“æ„

åœ¨ä¸Šä¸€ç¯‡å…³äºreactçš„æ–‡ç« æˆ‘æåˆ°è¿‡ï¼Œå‡½æ•°å¼ç»„ä»¶æ¯æ¬¡`reRender`éƒ½ä¼šé‡æ–°æ‰§è¡Œä¸€éï¼Œå¦‚æœæˆ‘ä»¬éœ€è¦ç”Ÿå‘½å‘¨æœŸçš„æ•ˆæœï¼Œé‚£æˆ‘ä»¬å°±éœ€è¦`useEffect`å‡½æ•°ã€‚æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹useEffectçš„ç»“æ„ï¼š

```js
useEffect(setup, dependencies?)
```

- å‚æ•°

    - `setup`ï¼šä¸€ä¸ªå®ç°äº†ä½ éœ€è¦çš„å‰¯ä½œç”¨é€»è¾‘çš„å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°å°†ä¼šåœ¨ç»„ä»¶é¦–æ¬¡è¢«ç»‘å®šä»¥åŠæ¯æ¬¡**é‡æ–°æ¸²æŸ“å¯¼è‡´`dependencies`æ›´æ–°æ—¶**è°ƒç”¨ã€‚åŒæ—¶ä»–è¿˜å¯ä»¥`return`ä¸€ä¸ªæ¸…é™¤å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°å°†ä¼šåœ¨å‡½æ•°å¸è½½ä»¥åŠæ¯æ¬¡**é‡æ–°æ¸²æŸ“å¯¼è‡´`dependencies`æ›´æ–°ä¹‹å‰**è°ƒç”¨

    - `dependencies`ï¼šåœ¨`setup`ä¸­å¼•ç”¨çš„æ‰€æœ‰`reactive values`ï¼ˆstateã€å‚æ•°ä»¥åŠåœ¨ç»„ä»¶å†…éƒ¨å®šä¹‰çš„å˜é‡å’Œå‡½æ•°ï¼‰æˆ–æ›´æ–°å‡­æ®ç»„æˆçš„æ•°ç»„ã€‚è¿™ä¸ªæ•°ç»„å¿…é¡»æ˜¯æœ‰é™çš„å¹¶ä¸”åå¹³çš„ï¼Œæ¯æ¬¡æ›´æ–°reactå°†ä½¿ç”¨`Object.is()`æ¯”è¾ƒæ¯ä¸ªä¾èµ–é¡¹æ˜¯å¦ä¸ä¹‹å‰ç›¸åŒï¼Œå¦‚æœä¸åŒåˆ™æ›´æ–°ã€‚

- return

    - `undefinded` ï¼ˆæ— è¿”å›å€¼ï¼‰

ä¸­æ–‡åšå®¢ä¸­ç»å¸¸ä¼šæ¼æ‰`setup`å‡½æ•°çš„è¿”å›å€¼ï¼Œä½†æ˜¯å®ƒçš„è¿”å›å€¼æ˜¯è¿™ä¸ªå‡½æ•°çš„åŠå£æ±Ÿå±±ï¼Œæˆ‘ä»¬å†³ä¸èƒ½å°†å…¶å¿½ç•¥ä¸æï¼Œå¦‚æœå¿½ç•¥æ‰çš„è¯æˆ‘ä»¬å°±æœ‰ä¸€åŠçš„æ•ˆæœæ— æ³•å®ç°äº†ã€‚

â—ï¼š`useEffect`ä¹Ÿæ˜¯ä¸€ä¸ªhookï¼Œè¯·åœ¨ç»„ä»¶æˆ–è€…è‡ªå®šä¹‰hookçš„æœ€ä¸Šå±‚ä½¿ç”¨ï¼Œä¸è¦åœ¨å¾ªç¯æˆ–åˆ†æ”¯ç»“æ„ä¸­å®šä¹‰hook

## æ¨¡æ‹Ÿç”Ÿå‘½å‘¨æœŸ

reactç”Ÿå‘½å‘¨æœŸå¤§æ¦‚åˆ†ä¸ºä¸‰ç§ï¼Œ`mount`ã€`update`ã€`unmount`ï¼Œå½“ç„¶åœ¨ç±»å¼ç»„ä»¶ï¼Œæˆ‘ä»¬å·²ç»å¯ä»¥è§„å®šæ˜¯åœ¨mountä¹‹å‰ï¼Œmountæ—¶è¿˜æ˜¯mountä¹‹åè°ƒç”¨ï¼Œåœ¨å‡½æ•°å¼ç»„ä»¶æˆ‘ä»¬å°±ä¸åˆ†çš„è¿™ä¹ˆæ¸…æ¥šäº†ï¼Œå› ä¸ºåœ¨å‡½æ•°å¼ç»„ä»¶æˆ‘ä»¬çš„ç”Ÿå‘½å‘¨æœŸå…¶å®æ˜¯ç‹¬ç«‹çš„ï¼Œæ˜¯é¢å‘çŠ¶æ€çš„ã€‚

ä¸‹é¢æˆ‘ä»¬å°±ä½¿ç”¨useEffectç®€å•æ¨¡æ‹Ÿä¸€ä¸‹ç±»å¼ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸï¼š

**åªåœ¨åˆå§‹åŒ–æ—¶æ‰§è¡Œ(`DidMounted`)** ï¼š

```js
// ä¸ä¾èµ–ä»»ä½•å˜é‡ï¼Œåˆ™ä¼ å…¥ä¸€ä¸ªç©ºæ•°ç»„
useEffect(() =&gt; {
    console.log(&quot;init&quot;);
    return () =&gt; {};
  }, []);
```

**æ¯æ¬¡æ›´æ–°æ—¶æ‰§è¡Œ(`render`)** ï¼š

```js
// ä¾èµ–æ‰€æœ‰å˜é‡ï¼Œåˆ™ä¸ä¼ å…¥
useEffect(() =&gt; {
    console.log(&quot;rerender&quot;);
  });
```

**æ¯æ¬¡å¸è½½æ—¶æ‰§è¡Œ(`beforeUnmount`)** ï¼š

```js
// ä¸ä¾èµ–ä»»ä½•å˜é‡ï¼Œreturnçš„å‡½æ•°å°†ä¼šåœ¨å¸è½½ä¹‹å‰è¢«è°ƒç”¨
useEffect(() =&gt; {
    return () =&gt; {console.log(&quot;unmount&quot;);};
  }, []);
```

å®é™…ä¸Šï¼Œæˆ‘ä»¬ç»å¸¸è¯´`useEffect`çš„ä½œç”¨æ˜¯æ¨¡æ‹Ÿå£°æ˜å‘¨æœŸï¼Œè€Œè¿™ä¼¼ä¹è¿èƒŒäº†å‡½æ•°å¼ç»„ä»¶çš„åˆè¡·ï¼Œä¹Ÿè¿èƒŒäº†`useEffect`çš„åˆè¡·ã€‚æˆ‘ä»¬åº”è¯¥å¤šä»**çŠ¶æ€**çš„è§’åº¦å»æ€è€ƒï¼Œ`useEffect`å¹¶éæ˜¯ä»€ä¹ˆç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼Œè€Œæ˜¯**çŠ¶æ€æ›´æ–°**å‡½æ•°ã€‚

## æ§åˆ¶æ›´æ–°

å¦‚æœæŸä¸ªå˜é‡åœ¨æ¯æ¬¡ç»„ä»¶æ›´æ–°çš„æ—¶å€™éƒ½éœ€è¦æ›´æ–°ï¼Œé‚£æˆ‘ä»¬å®Œå…¨æ²¡æœ‰å¿…è¦ä½¿ç”¨`useEffect`ï¼Œæˆ‘ä»¬ä½¿ç”¨å‰¯ä½œç”¨é’©å­ä¸€å®šæ˜¯å› ä¸ºæˆ‘ä»¬éœ€è¦æ§åˆ¶æŸä¸ªå˜é‡çš„æ›´æ–°ã€‚

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨`useEffect`å°†**ç»„ä»¶å†…éƒ¨çš„çŠ¶æ€ä¸ç»„ä»¶å¤–éƒ¨ç³»ç»ŸåŒæ­¥**ï¼š

```jsx
// æ¯”å¦‚è¯´ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨çˆ¶ç»„ä»¶æ›´æ–°propsçš„æ—¶å€™è°ƒç”¨useEffect
const Child = ({ count }) =&gt; {
  const [childContext, setChildContext] = useState(0);
  useEffect(() =&gt; {
    setChildContext(count);
  }, [count]);
  return &lt;p&gt;this is a child, count = {childContext}&lt;/p&gt;;
};
```

æˆ–è€…æˆ‘ä»¬å¯ä»¥ä½¿ç”¨`useEffect`å°†**ç»„ä»¶ç»„ä»¶å¤–éƒ¨ç³»ç»Ÿä¸å†…éƒ¨çš„çŠ¶æ€åŒæ­¥**ï¼š

```jsx
import &quot;./styles.css&quot;;
import { useEffect, useState } from &quot;react&quot;;

const fetch = async (count) =&gt; {
  // å‡è®¾è¿™æ˜¯ä¸€ä¸ªç½‘ç»œè¯·æ±‚
  // å½“ç„¶ï¼Œè¿™ä¸ªå¤–éƒ¨çŠ¶æ€ä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªå¤–éƒ¨ç»„ä»¶ï¼Œå¤–éƒ¨å˜é‡ï¼ŒjsAPIç­‰ç­‰
  await new Promise(() =&gt; {
    setTimeout(() =&gt; {
      console.log(&quot;fetch date&quot;);
    }, count);
  });
};

export default function App() {
  const [count, setCount] = useState(0);
  const onClick = () =&gt; {
    setCount(count + 1);
  };
  // æ¯æ¬¡ä¿®æ”¹countéƒ½ä¼šå°†æ›´æ”¹åŒæ­¥å¤–éƒ¨ç³»ç»Ÿ
  useEffect(() =&gt; {
    fetch(count);
  }, [count]);
  return (
    &lt;div className=&quot;App&quot;&gt;
      &lt;button onClick={onClick}&gt;Change state in father&lt;/button&gt;
      &lt;p&gt;count is {count}&lt;/p&gt;
    &lt;/div&gt;
  );
}
```

å…¶å®ç”Ÿå‘½å‘¨æœŸä¹Ÿä¸è¿‡æ˜¯å¯¹çŠ¶æ€çš„ç»Ÿä¸€æ›´æ”¹ï¼Œreactç°åœ¨åªæ˜¯å°†ç”Ÿå‘½å‘¨æœŸå°†é¢—ç²’åº¦ä»ç»„ä»¶é™ä½åˆ°äº†çŠ¶æ€ã€‚

## ä¸€äº›tips

### åœ¨useEffectä¸­ä½¿ç”¨state

æœ‰æ—¶å€™æˆ‘ä»¬å¯èƒ½ä¼šéœ€è¦åœ¨`useEffect`ä¸­ä½¿ç”¨å’Œä¿®æ”¹`state`ï¼Œä½†æ˜¯è¿™æ˜¯æç«¯å±é™©çš„è¡Œä¸ºï¼Œå› ä¸ºå½“æˆ‘ä»¬ä¿®æ”¹`state`æ—¶ä¼šè§¦å‘é¡µé¢çš„`rerender`ï¼Œç„¶åå› ä¸º`useEffect`ä¾èµ–äº†`state`ï¼Œè¿™å°†ä¼šå¯¼è‡´`state`è¢«å†æ¬¡æ›´æ”¹ç»§è€Œå¼•èµ·æ­»å¾ªç¯â€¦â€¦

```jsx
const Child = ({ count }) =&gt; {
    const [childContext, setChildContext] = useState(0);
    useEffect(() =&gt; {
        setChildConte(childContext);
    }, [count, childContext]);
    // !! åƒä¸‡ä¸è¦è¿™ä¹ˆåšï¼Œä¼šå¼•å‘æ­»å¾ªç¯
    return &lt;p&gt;this is a child, count = {childContext}&lt;/p&gt;;
};
```

å¦‚æœæˆ‘ä»¬åœ¨`useEffect`ä¸­æ ¹æ®ä¹‹å‰çš„stateæ›´æ–°stateï¼Œæˆ‘ä»¬å¯ä»¥è¿™ä¹ˆå†™ï¼š

```jsx
useEffect(() =&gt; {
  setChildContext(c =&gt; c + 1);
}, [count]);
// ä¸éœ€è¦ä¾èµ–childContextï¼Œå®‰å…¨
```

å¦‚æœä½ çœŸçš„æ—¢è¦åœ¨Effectä¸­è¯»å–stateï¼Œåˆè¦ä¿®æ”¹stateï¼Œé‚£ä¹ˆæˆ‘ç»™å‡ºçš„å»ºè®®æ˜¯ï¼Œï¼š**ä½¿ç”¨ä¸¤ä¸ªä¾èµ–åŒä¸€ä¸ªæ›´æ–°å‡­è¯`useEffect`**

åƒä¸‡åˆ«è¿™ä¹ˆåšï¼š

```jsx
useEffect(() =&gt; {
  setChildContext(Math.random())
  console.log(childContext)
}, [count, childContext])
// æ­»å¾ªç¯ï¼ï¼ğŸ˜­
```

æ­£ç¡®çš„åšæ³•å¦‚ä¸‹ï¼š

```jsx
useEffect(() =&gt; {
  setChildContext(Math.random())
}, [count]);
useEffect(() =&gt; {
  console.log(childContext)
}, [count, childContext])
// å®‰å…¨ğŸ˜Š
```

### æ¶ˆé™¤ä¸å¿…è¦çš„å¯¹è±¡ä¸å‡½æ•°ä¾èµ–

å¦‚æœæˆ‘ä»¬åœ¨ç»„ä»¶å†…å®šä¹‰äº†ä¸€ä¸ªå‡½æ•°æˆ–å¯¹è±¡ï¼Œæˆ‘ä»¬åœ¨ä¸Šä¸€ç¯‡æ–‡ç« è¯¦ç»†è®²è¿‡ï¼Œå®ƒæ¯æ¬¡éƒ½ä¼šè¢«åˆå§‹åŒ–ã€‚å°±åƒè¿™æ ·ï¼š

```jsx
const childContext = {
    count: 1
}
useEffect(() =&gt; {
    childContext.count = count;
    console.log(&quot;run effect&quot;)
    // ä¸è¦è¿™æ ·ï¼Œæ¯æ¬¡Renderéƒ½ä¼šè§¦å‘effectğŸ˜”
}, [count, childContext]);
```

å–è€Œä»£ä¹‹çš„æ˜¯ï¼Œå¦‚æœä½ çš„å¯¹è±¡æˆ–è€…å‡½æ•°åªåœ¨`useEffect`ä¸­ä½¿ç”¨ï¼Œåˆ™å†™åœ¨`setup`å†…éƒ¨

```jsx
const Child = ({count}) =&gt; {
  useEffect(() =&gt; {
    const childContext = {
      count: 1
    }
    childContext.count = count;
    console.log(&quot;run effect&quot;)
  }, [count]);
  // æ¨èï¼Œåªæœ‰åœ¨ä¾èµ–æ›´æ–°çš„æ—¶å€™æ‰ä¼šè§¦å‘effect ğŸ˜Š
  return &lt;p&gt;this is a child&lt;/p&gt;;
};
```

å¦‚æœä½ æ˜¯å¸Œæœ›æœ‰ä¸€ä¸ªåœ¨æ•´ä¸ªç»„ä»¶éƒ½å¯ä»¥è¢«è®¿é—®çš„é™æ€å˜é‡ï¼Œé‚£ä¹ˆå¯ä»¥å°†å¯¹è±¡å†™åœ¨ç»„ä»¶å¤–éƒ¨ï¼š

```jsx
const childContext = {
  count: 1
}
const Child = ({count}) =&gt; {
  useEffect(() =&gt; {
    childContext.count = count;
    console.log(&quot;run effect&quot;)
  }, [count]);
  // æ¨èï¼Œåªæœ‰åœ¨ä¾èµ–æ›´æ–°çš„æ—¶å€™æ‰ä¼šè§¦å‘effect ğŸ˜Š
  return &lt;p&gt;this is a child&lt;/p&gt;;
};
```

## useLayoutEffect

æˆ‘ä»¬åœ¨ä½¿ç”¨`useEffect`çš„æ—¶å€™æœ‰æ—¶ä¼šå‡ºç°ä¸€ç§é—®é¢˜ï¼šæˆ‘ä»¬çš„ç»„ä»¶ä¼šå‘ç”Ÿé—ªçƒæˆ–çªç„¶çš„å˜åŒ–ã€‚

è¿™æ—¶å› ä¸º`useEffect`æ˜¯åœ¨`mount`ä¹‹åæ‰§è¡Œçš„ï¼Œå› æ­¤ç¬¬ä¸€æ¬¡æ¸²æŸ“å‡ºçš„å€¼æ˜¯æˆ‘ä»¬å®šä¹‰çš„åˆå§‹å€¼ï¼Œå¦‚æœæ›´æ–°çš„æ€§èƒ½æ¯”è¾ƒå·®æˆ–è€…æ›´æ–°çš„èŒƒå›´æ¯”è¾ƒå¤§ï¼Œå¯èƒ½ä¼šå¯¼è‡´æˆ‘ä»¬çš„`view`å‘ç”Ÿé—ªçƒçš„ç°è±¡ã€‚

è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨`useLayoutEffect`ï¼Œä»–å’Œ`useEffect`çš„æœ€å¤§åŒºåˆ«å°±æ˜¯ä»–æ˜¯åœ¨`mount`ä¹‹å‰æ‰§è¡Œçš„ï¼Œæ‰€ä»¥ä¸ä¼šå¯¼è‡´`view`çš„é—ªçƒã€‚

ä½†æ˜¯å¦‚æœæˆ‘ä»¬æ²¡æœ‰å¾ˆæ˜æ˜¾çš„uié—ªçƒé—®é¢˜ï¼Œæˆ‘ä»¬åº”è¯¥å°½å¯èƒ½çš„ä½¿ç”¨`useEffect`ï¼Œå› ä¸ºå®ƒçš„è¿è¡Œæ•ˆç‡æ›´å¥½ã€‚</p> </div> </div> </a>  </div><div class="card-item" data-astro-cid-p3vyftr4> <a href="/blog/technology/react/where-put-react-func/" class="card-link" data-astro-cid-dohjnao5> <div class="card" data-astro-cid-dohjnao5> <div class="card-image" data-astro-cid-dohjnao5>  </div> <div class="card-content" data-astro-cid-dohjnao5> <h3 class="card-title" data-astro-cid-dohjnao5>åº”è¯¥åœ¨å“ªé‡Œå®šä¹‰reactå‡½æ•°â€”â€”å…³äºreactå¼€å‘è§„èŒƒçš„ä¸€äº›ç†è§£</h3> <p class="card-description" data-astro-cid-dohjnao5># åº”è¯¥åœ¨å“ªé‡Œå®šä¹‰reactå‡½æ•°â€”â€”å…³äºreactå¼€å‘è§„èŒƒçš„ä¸€äº›ç†è§£

## å‰è¨€

æˆ‘ä¹‹å‰æœ‰ä¸€ä¸ªåŒäº‹ï¼Œä»vueæŠ€æœ¯æ ˆè½¬å…¥reactæŠ€æœ¯æ ˆï¼Œå¯¹äºå‡½æ•°å¼ç¼–ç¨‹è¿˜æœ‰ä¸€äº›ä¸å¤ªç†Ÿæ‚‰ã€‚

æœ€è¿‘ä»–é—®äº†æˆ‘ä¸€ä¸ªé—®é¢˜ï¼Œ**reactå‡½æ•°åº”è¯¥å®šä¹‰åœ¨ä»€ä¹ˆåœ°æ–¹**ï¼Ÿä»–å‘ç°æœ‰äº›å‡½æ•°å†™åœ¨reactç»„ä»¶ä¹‹å†…ï¼Œæœ‰äº›å´å†™åœ¨reactå‡½æ•°ä¹‹å¤–ã€‚ä»–æƒ³çŸ¥é“å“ªç§åšæ³•æ˜¯æœ€åˆé€‚çš„ã€‚è¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é—®é¢˜ï¼Œå› ä¸ºè¿™ä½“ç°äº†å¯¹äºä»£ç è§„èŒƒçš„è¿½æ±‚ã€‚ç°åœ¨æˆ‘å¸Œæœ›åœ¨æ­¤å¦¥å–„çš„æ¢³ç†ä¸€ä¸‹è¿™ä¸ªé—®é¢˜ã€‚

## çœ‹æ³•

å…ˆå¼€é—¨è§å±±çš„è¯´ä¸€ä¸‹æˆ‘çš„çœ‹æ³•ï¼Œæˆ‘çš„çœ‹æ³•å°±æ˜¯&lt;mark&gt;åº”å¤–å°½å¤–&lt;/mark&gt;ï¼Œæ„æ€å°±æ˜¯**èƒ½å¤Ÿ**æ”¾åˆ°ç»„ä»¶å¤–éƒ¨çš„å‡½æ•°éƒ½åº”è¯¥æ”¾åˆ°å¤–éƒ¨ã€‚ä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåªæœ‰æ»¡è¶³ä¸€å®šæ¡ä»¶çš„å‡½æ•°æ‰èƒ½å¤Ÿæ”¾åˆ°ç»„ä»¶å¤–éƒ¨ã€‚åœ¨å…·ä½“çš„è®¨è®ºè¿™äº›è§„åˆ™ä¹‹å‰ï¼Œæˆ‘ä»¬åº”è¯¥å…ˆæ¥çœ‹ä¸€ä¸‹å‡½æ•°å†™åœ¨ç»„ä»¶å†…ä¸ç»„ä»¶å¤–éƒ¨çš„&lt;mark&gt;åŒºåˆ«&lt;/mark&gt;ã€‚

## åŒºåˆ«

å…¶å®ä¸¤è€…çš„åŒºåˆ«ååˆ†æ˜¾è‘—ï¼Œæˆ‘ä»¬åœ¨ç¼–å†™`jsx`æ–‡ä»¶çš„æ—¶å€™ä¸€èˆ¬æ¯ä¸ªæ–‡ä»¶ä¼šæš´éœ²ä¸€ä¸ªæ–‡ä»¶å…¥å£ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬çš„ç»„ä»¶å‡½æ•°ã€‚å½“æˆ‘ä»¬åœ¨çˆ¶ç»„ä»¶ä½¿ç”¨æˆ‘ä»¬çš„å­ç»„ä»¶çš„æ—¶å€™ï¼Œå®é™…ä¸Šå°±ç›¸å½“äº`new`å‡ºäº†ä¸€ä¸ªæ–°çš„ç»„ä»¶å®ä¾‹ã€‚è€Œåœ¨ç»„ä»¶å¤–çš„å‡½æ•°æˆ–è€…å˜é‡ï¼Œåˆ™ä¸ç»„ä»¶å½¢æˆäº†é—­åŒ…ã€‚ï¼ˆä¸å¤ªäº†è§£é—­åŒ…çš„å¯ä»¥ç†è§£ä¸ºç»„ä»¶å†…çš„ä¸œè¥¿æ˜¯åŸå‹æ¨¡å¼ï¼Œè€Œç»„ä»¶å¤–çš„ä¸œè¥¿æ˜¯å•ä¾‹æ¨¡å¼ï¼‰

æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªä¾‹å­ï¼š

é¦–å…ˆæˆ‘ä»¬æœ‰ä¸€ä¸ªTestç»„ä»¶ï¼š

```jsx
let a = &quot;123&quot;;

const Test = (props) =&gt; {
    return(
        &lt;&gt;
            &lt;button onClick={()=&gt;{console.log(a);a = props.value;}}&gt;change&lt;/button&gt;
        &lt;/&gt;

    )
}

export default Test;
```

ç„¶åæˆ‘ä»¬åœ¨App.jsä¸­è°ƒç”¨è¿™ä¸ªç»„ä»¶ï¼š

```js
function App() {
  return (
    &lt;div className=&quot;App&quot;&gt;
      &lt;Test value={666}&gt;&lt;/Test&gt;
      &lt;Test value={777}&gt;&lt;/Test&gt;
    &lt;/div&gt;
  );
}
```

å¯ä»¥çœ‹åˆ°æˆ‘ä»¬åœ¨è¿™é‡Œè°ƒç”¨äº†ä¸¤æ¬¡Testç»„ä»¶ï¼Œé¡µé¢ä¸Šåº”å½“æœ‰ä¸¤ä¸ªæŒ‰é’®ã€‚

è¿™æ—¶æˆ‘ä»¬åº”è¯¥æƒ³ä¸€ä¸‹ï¼Œå½“æˆ‘ä»¬ä¾æ¬¡ç‚¹å‡»è¿™ä¸¤ä¸ªæŒ‰é’®çš„æ—¶å€™è¾“å‡ºçš„æ˜¯

&gt; 123 123

è¿˜æ˜¯

&gt; 123 666

å‘¢ï¼Ÿ

ç­”æ¡ˆæ˜¾è€Œæ˜“è§ï¼Œæ˜¯`123 666`ï¼Œå„ä½å¯ä»¥è‡ªå·±å»å°è¯•ä¸€ä¸‹ã€‚å¯¼è‡´è¿™ç§ç°è±¡å‡ºç°çš„åŸå› å…¶å®ä¸æ˜¯reactçš„ç»„ä»¶ï¼Œè€Œæ˜¯æˆ‘ä»¬çš„`esm`ã€‚æˆ‘ä»¬åº”è¯¥éƒ½å¯¹é—­åŒ…æœ‰ä¸€å®šçš„æ¦‚å¿µï¼Œå…¶å®æˆ‘ä»¬çš„æ¨¡å—åŒ–æ­£æ˜¯ä½¿ç”¨äº†é—­åŒ…è¿™ä¸€æ¦‚å¿µã€‚å½“æˆ‘ä»¬åƒä¸Šæ–‡é‚£æ ·ç¼–å†™Testç»„ä»¶çš„æ—¶å€™ï¼Œå…¶å®é—­åŒ…å°±å·²ç»å½¢æˆäº†ã€‚

ä¸‹é¢æˆ‘ä»¬æ¥æ¢³ç†ä¸€ä¸‹å“ªäº›å‡½æ•°æ˜¯éœ€è¦æ”¾åˆ°ç»„ä»¶å†…çš„ä»¥åŠè¿™å…¶ä¸­çš„åŸå› ã€‚

## éœ€è¦åœ¨ç»„ä»¶å†…çš„å‡½æ•°

### Hookå‡½æ•°

ä¸€ä¸ªhookå‡½æ•°åªèƒ½åœ¨ä»¥ä¸‹ä¸¤ä¸ªä½ç½®å®šä¹‰ï¼š

1. è‡ªå®šä¹‰hookå‡½æ•°å†…éƒ¨

2. Reactç»„ä»¶å†…éƒ¨

ä½†æ˜¯å…¶å®æˆ‘ä»¬çš„è‡ªå®šä¹‰hookæœ€ç»ˆä¹Ÿæ˜¯åœ¨Reactç»„ä»¶å†…éƒ¨è°ƒç”¨ï¼Œæ‰€ä»¥è¿™å°±ç›¸å½“äºæ¯ä¸€ä¸ªHookå‡½æ•°æœ€ç»ˆéƒ½å¿…é¡»åœ¨Reactç»„ä»¶å†…éƒ¨ç¯å¢ƒä¸­æ‰§è¡Œã€‚

### ä¾èµ–Hookå‡½æ•°çš„å‡½æ•°

ä¸Šæ–‡è¯´è¿‡ï¼Œhookå‡½æ•°åªèƒ½åœ¨Reactç»„ä»¶å†…éƒ¨è°ƒç”¨ï¼Œé‚£ä¹ˆè°ƒç”¨hookå‡½æ•°çš„å‡½æ•°ä¹Ÿç†æ‰€åº”å½“çš„éœ€è¦å†™åœ¨ç»„ä»¶å†…éƒ¨ã€‚

### ä¾èµ–Stateçš„å‡½æ•°

å¦‚æœæˆ‘ä»¬çš„å‡½æ•°éœ€è¦ç›´æ¥ä½¿ç”¨Stateçš„å€¼ï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦å°†è¿™ä¸ªå‡½æ•°æ”¾ç½®åœ¨ç»„ä»¶å†…éƒ¨ï¼Œå› ä¸ºstateæ˜¯æ¯ä¸€ä¸ªç»„ä»¶å®ä¾‹ç§æœ‰çš„ï¼Œåœ¨å¤–éƒ¨çš„å‡½æ•°æ— æ³•è¯»å–åˆ°è¿™ä¸ªå€¼ã€‚ä½†æ˜¯å¯¹äºå¯èƒ½ä¼šå¤ç”¨çš„å‡½æ•°æˆ‘ä»¬è¿˜æ˜¯æ›´æ¨èå¤§å®¶ä½¿ç”¨å‚æ•°ä¼ é€’çš„æ–¹å¼ä¼ é€’stateçš„å€¼ç„¶åå†ä½¿ç”¨setStateçš„æ–¹å¼è®¾ç½®è¿”å›å€¼ã€‚

ä¸æ¨èï¼š

```jsx
// :(   not recommend

// a.jsx
const [count,setCount] = useState(1);
function a(){
    setCount(count+2);
}
// b.jsx
const [count,setCount] = useState(2);
function b(){
    setCount(count+2);
}
```

æ¨è

```jsx
// :)  recommend

//calcCount.js
function calcCount(count){
    return count+2;
}
//a.jsx
const [count,setCount] = useState(1);
setCount(calcCount(count));
// b.jsx
const [count,setCount] = useState(2);
setCount(calcCount(count));
```

### ä¾èµ–propsçš„å‡½æ•°

ä¾èµ–propsçš„å‡½æ•°å½“ç„¶ä¹Ÿä¸èƒ½å°†å…¶å†™åœ¨ç»„ä»¶å¤–é¢ã€‚æˆ‘ä»¬å¾ˆå¤§ç¨‹åº¦ä¸Šæ˜¯é€šè¿‡propså»åŒºåˆ«æŸä¸€ä¸ªç»„ä»¶å‡½æ•°çš„ä¸åŒå®ä¾‹çš„ï¼Œæ‰€ä»¥propsä¹Ÿæ˜¯ç»„ä»¶å®ä¾‹ç§æœ‰çš„ï¼Œéœ€è¦å†™åœ¨å¤–é¢ã€‚

### äº‹ä»¶å¤„ç†å‡½æ•°

è™½ç„¶äº‹ä»¶å¤„ç†å‡½æ•°ä»ç†è®ºä¸Šæ¥è¯´å®Œå…¨å¯ä»¥æ”¾ç½®åˆ°ç»„ä»¶å¤–éƒ¨ï¼ˆåªè¦ä¸ä¾èµ–ä¸Šé¢æ‰€è¯´çš„ï¼‰ï¼Œä½†æ˜¯æˆ‘ä»¬ä¼šè®¤ä¸ºäº‹ä»¶å¤„ç†å‡½æ•°æ˜¯æ¯”è¾ƒç§äººçš„ä¸œè¥¿ï¼Œä»ä¹ æƒ¯ä¸Šæ¥è¯´æˆ‘ä»¬è¿˜æ˜¯æ›´ä¹ æƒ¯å°†å…¶æ”¾åˆ°ç»„ä»¶çš„å†…éƒ¨è€Œä¸æ˜¯æŠ½å‡ºåˆ°ä¸€ä¸ªutilæ–‡ä»¶ä¸­ï¼Œè€Œä¸”å¯¹äºä¸åŒç»„ä»¶çš„äº‹ä»¶å¤„ç†å‡½æ•°ï¼Œæˆ‘ä»¬èƒ½æŠ½è±¡çš„éƒ¨åˆ†ä¹Ÿä¼˜å…ˆã€‚

è€Œä¸”æ¯”èµ·å°†äº‹ä»¶å¤„ç†å‡½æ•°æŠ½è±¡å‡ºæ¥ï¼Œæˆ‘ä»¬æ›´æ¨èå°†äº‹ä»¶å¤„ç†å‡½æ•°ä¸­å¤„ç†é€»è¾‘çš„éƒ¨åˆ†ä»£ç æŠ½å–å‡ºæ¥ï¼Œç±»ä¼¼æˆ‘ä»¬åœ¨MVCæ¡†æ¶ä¸­æ‰€ä½œçš„é‚£æ ·ï¼Œmodelä¸controllerçš„åˆ†ç¦»æ˜¯å€¼å¾—æ¨å´‡çš„è®¾è®¡æ€æƒ³ã€‚

### å…¶ä»–ä¾èµ–ç»„ä»¶å®ä¾‹çš„æ–¹æ³•ã€å˜é‡çš„å‡½æ•°

å…¶å®æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå‡¡æ˜¯æˆ‘ä»¬çš„å‡½æ•°ä¾èµ–äº†æˆ‘ä»¬ç»„ä»¶å®ä¾‹çš„ç§æœ‰å˜é‡ã€æ–¹æ³•ï¼Œæˆ‘ä»¬éƒ½éœ€è¦æ”¾åœ¨ç»„ä»¶å†…éƒ¨ã€‚

## ä¸ºå•¥åº”å¤–å°½å¤–ï¼Ÿ

ä»¥ä¸Šæˆ‘ä»¬æ•´ç†å‡ºå¾ˆå¤šéœ€è¦æ”¾åˆ°ç»„ä»¶å†…éƒ¨çš„æƒ…å†µï¼Œé‚£ä¸ºå•¥è¿˜æ¨èæ”¾åˆ°å‡½æ•°å¤–éƒ¨å‘¢ï¼Ÿç›´æ¥å…¨éƒ¨æ”¾åˆ°å‡½æ•°å†…éƒ¨ä¸æ˜¯ä¼šç®€å•å¾ˆå¤šå—ï¼Ÿ

å°½é‡å°†å‡½æ•°æ”¾åˆ°å¤–é¢å…¶å®æ˜¯ä¸€ç§å‡½æ•°å¼ä¸æ¨¡å—åŒ–çš„è®¾è®¡æ€æƒ³ï¼Œä»–é©±ä½¿æˆ‘ä»¬å°½å¯èƒ½å»å¤ç”¨æˆ‘ä»¬çš„å‡½æ•°ä»¥åŠä½¿ç”¨çº¯å‡½æ•°ï¼Œç»¼åˆæ¥è¯´ï¼Œå°†å‡½æ•°ä¸å˜é‡æ”¾åˆ°å¤–éƒ¨æœ‰å¦‚ä¸‹å‡ ä¸ªå¥½å¤„ï¼š

- å‡å°‘å†…å­˜å ç”¨ï¼šå‡å°‘ç»„ä»¶å†…éƒ¨çš„å‡½æ•°ä¸å˜é‡å¯ä»¥å‡å°‘ç»„ä»¶å®ä¾‹ä¸­çš„å†…å®¹ï¼Œå‡å°‘å¯¹å†…å­˜çš„å ç”¨

- é‡ç”¨ä»£ç ï¼šæˆ‘ä»¬å®Œå…¨å¯ä»¥å°†ä¸€äº›è´Ÿè´£é€»è¾‘ã€å¯ä»¥é‡ç”¨çš„å‡½æ•°å½’ç±»å¹¶ä¸”æ”¾ç½®åˆ°æ–¹æ³•ç±»ï¼ˆutils.jsä¹‹ç±»ï¼‰ä¸­ï¼Œå‡å°‘æˆ‘ä»¬çš„ä»£ç é‡

- æ¨¡å—åŒ–ï¼šæˆ‘ä»¬å°†é€»è¾‘ä¸è§†å›¾æŠ½ç¦»å®Œå…¨å¯ä»¥å‡å°‘æˆ‘ä»¬ç»„ä»¶çš„è€¦åˆåº¦ï¼Œå¹¶ä¸”å¯ä»¥é™ä½æ¨¡å—ä½“ç§¯ï¼Œæé«˜æˆ‘ä»¬æ¨¡å—åŒ–çš„â€œæ•ˆç‡â€ã€‚è€Œä¸”èƒ½å¤Ÿä½¿æˆ‘ä»¬å°½é‡å»ä½¿ç”¨çº¯å‡½æ•°ç¼–å†™æ›´ä¼˜é›…ã€æ›´å®¹æ˜“ç»´æŠ¤çš„ä»£ç 

- å…±äº«ä¿¡æ¯ï¼šæˆ‘ä»¬å¯ä»¥åˆ»æ„çš„é€šè¿‡å°†æ•°æ®æ”¾ç½®åˆ°ç»„ä»¶å¤–è®©è¿™ä¸ªç»„ä»¶çš„ä¸åŒå®ä¾‹å»å…±äº«ä¿¡æ¯ã€‚ä¸è¿‡éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬æ”¾åˆ°ç»„ä»¶å¤–çš„æ•°æ®è‚¯å®šä¸æ˜¯`React State`ï¼Œè¿™å°±æ„å‘³ç€å®ƒä»¬ä¸æ˜¯å“åº”å¼çš„ï¼ˆä¸€èˆ¬ä¸ä¼šæœ‰äººè¿™ä¹ˆåšå§ï¼Ÿï¼‰

ç»¼ä¸Šæ‰€è¿°ï¼Œå¯¹äºèƒ½å¤Ÿæ”¾ç½®åˆ°ç»„ä»¶å‡½æ•°å¤–çš„åº”è¯¥å°½é‡æ”¾ç½®åˆ°å‡½æ•°å¤–ï¼Œå¯¹äºèƒ½å¤Ÿå¤ç”¨çš„ä»£ç ç‰‡ï¼Œæœ€å¥½æ˜¯èƒ½å¤ŸæŠ½å–æˆå…¨å±€çš„å‡½æ•°ï¼Œè¿™æ ·æ‰æ›´ç¬¦åˆæ¨¡å—åŒ–çš„è¦æ±‚ã€‚</p> </div> </div> </a>  </div><div class="card-item" data-astro-cid-p3vyftr4> <a href="/blog/technology/program/what_eq_return/" class="card-link" data-astro-cid-dohjnao5> <div class="card" data-astro-cid-dohjnao5> <div class="card-image" data-astro-cid-dohjnao5>  </div> <div class="card-content" data-astro-cid-dohjnao5> <h3 class="card-title" data-astro-cid-dohjnao5>Cè¯­è¨€ç­‰äºè¿ç®—ç¬¦è¿”å›ä»€ä¹ˆï¼Ÿ</h3> <p class="card-description" data-astro-cid-dohjnao5>ä»Šå¤©æœ‰ä¸€ä½éCSä¸“ä¸šçš„åŒå­¦é—®äº†æˆ‘ä¸€é“é¢˜ï¼Œé¢˜å¹²æ˜¯ï¼š
&gt; èµ‹å€¼è¡¨è¾¾å¼a=5çš„å€¼æ˜¯____

æ€è€ƒä¸€å°ä¸‹ï¼Œä½ è§‰å¾—ç­”æ¡ˆæ˜¯ä»€ä¹ˆï¼Ÿ

&lt;!--more--&gt;

æˆ‘ç»™å‡ºçš„ç­”æ¡ˆæ˜¯`void`ï¼Œå› ä¸ºæˆ‘çš„è®°å¿†ä¸­æ²¡æœ‰å…³äºèµ‹å€¼è¡¨è¾¾å¼çš„è¿”å›å€¼æ˜¯ä»€ä¹ˆçš„ç­”æ¡ˆï¼Œäºæ˜¯æˆ‘æ ¹æ®æˆ‘çš„ç»éªŒï¼Œ
ç»™å‡ºäº†è¿™ä¸ªæˆ‘è§‰å¾—æœ€æœ‰å¯èƒ½çš„ç­”æ¡ˆã€‚ä½†æ˜¯æˆ‘æœ¬äººä¹Ÿå¯¹è¿™ä¸ªç­”æ¡ˆæŒæ€€ç–‘æ€åº¦

äºæ˜¯æˆ‘ä¾¿æŸ¥é˜…äº†C reference
![](what_eq_return/ref.png)

è¿™æ‰å‘ç°ï¼ŒåŸæ¥æ˜¯æœ‰è¿”å›å€¼çš„ï¼Œ**è€Œä¸”è¿”å›å€¼æ˜¯ç­‰å·å·¦è¾¹çš„å˜é‡çš„å€¼**ã€‚
äºæ˜¯æˆ‘ä¾¿æ•²äº†ä¸€ä¸ªç¨‹åºæ¥éªŒè¯ï¼Œè¿è¡Œç»“æœæœç„¶å’ŒC referenceä¸­çš„æè¿°çš„ä¸€æ ·
```c
#include&lt;iostream&gt;
using namespace std;
int main()
{
	int a=1;
	printf(&quot;%d&quot;,a=5);
	return 0;
} 
```
è¿è¡Œç»“æœï¼š5</p> </div> </div> </a>  </div><div class="card-item" data-astro-cid-p3vyftr4> <a href="/blog/subject/qccstp/kmp/" class="card-link" data-astro-cid-dohjnao5> <div class="card" data-astro-cid-dohjnao5> <div class="card-image" data-astro-cid-dohjnao5>  </div> <div class="card-content" data-astro-cid-dohjnao5> <h3 class="card-title" data-astro-cid-dohjnao5>è½¯è€ƒå¤ä¹ ä¹‹KMPç®—æ³•</h3> <p class="card-description" data-astro-cid-dohjnao5># KMPç®—æ³•

KMPç®—æ³•æˆ‘æ›¾ä»Šå†™è¿‡ä¸€ç¯‡[åšå®¢](https://blog.csdn.net/Charlesix59/article/details/119875803)è®²è¿‡ï¼Œä½†æ˜¯æˆ‘å½“æ—¶è§‰å¾—è¿™ä¸ªç®—æ³•å¥½çƒ‚ï¼Œå°±æ²¡ç»†è®²ï¼Œåæ¥å‘ç°ä»–ä»¬è¿˜æŒºå–œæ¬¢è€ƒè¿™ä¸ªç®—æ³•çš„ï¼Œäºæ˜¯æˆ‘å†å¼€å¸–è®²ä¸€ä¸‹

## è‡ªç„¶è¯­è¨€æè¿°

è‡ªç„¶è¯­è¨€æè¿°æ˜¯æˆ‘æ ¹æ®ã€Šalgorithmã€‹çš„å†…å®¹ä»¥åŠæˆ‘è‡ªå·±çš„ç†è§£å†™å‡ºæ¥çš„ï¼Œï¼Œä¸€èˆ¬æ¥è¯´æ˜¯æ­£ç¡®çš„è®¡ç®—next[]ä¸è§£é‡ŠKMPçš„ç®—æ³•ï¼Œè¿™ä¸ªæ–¹æ³•æ¯”è¾ƒè€ƒéªŒæ‚Ÿæ€§ï¼Œä½†æ˜¯åŸç†ç¡®å®æ˜¯è¿™æ ·ğŸ˜‚

![](kmp/1.png)

## è€ƒç ”æ•™æè§£é‡Š

æˆ‘ä»¬è¿˜æ˜¯æ‹¿`pat=abcac`ä¸¾ä¾‹å­ï¼Œæˆ‘ä»¬ä»aå¼€å§‹å–å­—ä¸²ï¼Œç„¶åæ‰¾å‰ç¼€ä¸åç¼€çš„æœ€é•¿ç›¸ç­‰é•¿åº¦

- â€aâ€œæœ€é•¿ç›¸ç­‰é•¿åº¦ä¸º0

- &quot;ab&quot;æœ€é•¿ç›¸ç­‰é•¿åº¦0

- &quot;abc&quot;æœ€é•¿ç›¸ç­‰é•¿åº¦0

- &quot;abca&quot;æœ€é•¿ç›¸ç­‰é•¿åº¦1

- &quot;abcac&quot;æœ€é•¿ç›¸ç­‰é•¿åº¦0


æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¾—åˆ°PM={0,0,0,1,0}

ä½†æ˜¯æˆ‘ä»¬æœ‰å…¬å¼`å³ç§»ä½æ•°=å·²åŒ¹é…çš„å­—ç¬¦æ•°-å¯¹åº”çš„éƒ¨åˆ†åŒ¹é…å€¼`

ç„¶å &lt;mark&gt;å¯¹åº”çš„éƒ¨åˆ†åŒ¹é…å€¼ æ˜¯ j å‰ä¸€ä¸ªå€¼&lt;/mark&gt;ï¼Œäºæ˜¯ä¸ºäº†æ–¹ä¾¿æˆ‘ä»¬æŠŠPMæ•´ä½“å³ç§»ä¸€ä½ï¼Œå¹¶ç”¨-1ä½œä¸ºnext[0]çš„å€¼ï¼Œå¾—åˆ°`next[]={-1,0,0,0,1}`

æ‰€ä»¥æˆ‘ä»¬æœ‰å…¬å¼ï¼š

`Move=(j-1)-next[j]`

è¿™å°±ç›¸å½“äºæˆ‘ä»¬å°†Jå›é€€åˆ°ï¼š

`jå›é€€åˆ°çš„ä½ç½®=j-Move=j-((j-1)-next[j])=next[j]+1`

æ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥éƒ½å¾—åˆ°next[]çš„æ–°çš„å½¢å¼ï¼š

`next[]={0,1,1,1,2}`

&lt;mark&gt;è¿™é‡Œnext[]çš„å«ä¹‰æ˜¯åœ¨jå¤„åŒ¹é…å¤±è´¥åï¼Œjå›é€€åˆ°çš„ä½ç½®&lt;/mark&gt;

## æ‹“å±•ï¼šæ›´åº•å±‚çš„åŒ¹é…æ–¹æ³•

å®é™…ä¸Šï¼ŒKMPç®—æ³•åº”è¯¥ç”Ÿæˆä¸€ä¸ªæœ‰é™çŠ¶æ€è‡ªåŠ¨æœºï¼ˆDFAï¼‰ï¼Œç„¶åé€šè¿‡DFAå»åŒ¹é…å­—ä¸²

ç»§ç»­æŒ‰ç…§`pat=abcac`ä¸ºä¾‹ï¼Œç”»å‡ºçš„DFAå¦‚ä¸‹ï¼š

![](kmp/2.jpg)

ç”ŸæˆDFAçš„ç®—æ³•å¦‚ä¸‹

```cpp
/*KMPå­—ç¬¦ä¸²æŸ¥æ‰¾*/
class KMP
{
private:
	std::string pat;
	const static int r = 256;
	int *dfa[r];    //å»ºç«‹ä¸€ä¸ªäºŒç»´æ•°ç»„
public:
	KMP(std::string pat)
	{
		this-&gt;pat = pat;
		int m = pat.length();
		for (int i = 0; i &lt; r; i++)
		{
			dfa[i] = new int[m];
			std::fill(dfa[i], dfa[i] + m, 0);
		}
		dfa[pat[0]][0] = 1;
		for (int x = 0, j = 1; j &lt; m; j++)
		{
			for (int c = 0; c &lt; r; c++)
			{
				dfa[c][j] = dfa[c][x];	//å¤åˆ¶åŒ¹é…å¤±è´¥æƒ…å†µä¸‹çš„å€¼
			}
			dfa[pat[j]][j] = j + 1;		//è®¾ç½®åŒ¹é…æˆåŠŸæƒ…å†µä¸‹çš„å€¼
			x = dfa[pat[j]][x];		//æ›´æ–°é‡å¯çŠ¶æ€
		}
	}
	int seatch(std::string txt)
	{
		int i, j, n = txt.length(), m = pat.length();
		for (i = 0, j = 0; i &lt; n&amp;&amp;j &lt; m; i++)
		{
			j = dfa[txt[i]][j];
		}
		if (j == m)
			return i - m;		//æ‰¾åˆ°åŒ¹é…
		else
			return n;		//æœªæ‰¾åˆ°åŒ¹é…
	}
};

```</p> </div> </div> </a>  </div><div class="card-item" data-astro-cid-p3vyftr4> <a href="/blog/technology/react/why_useref/" class="card-link" data-astro-cid-dohjnao5> <div class="card" data-astro-cid-dohjnao5> <div class="card-image" data-astro-cid-dohjnao5>  </div> <div class="card-content" data-astro-cid-dohjnao5> <h3 class="card-title" data-astro-cid-dohjnao5>ä¸ºä½•ä¸æ¨èåœ¨reactç»„ä»¶ä¸­ç›´æ¥å®šä¹‰å˜é‡ï¼Ÿæ¢ç§˜useRefçš„ä½¿ç”¨ä»¥åŠuserRefä¸useStateçš„åŒºåˆ«</h3> <p class="card-description" data-astro-cid-dohjnao5># ä¸ºä½•ä¸æ¨èåœ¨reactç»„ä»¶ä¸­ç›´æ¥å®šä¹‰å˜é‡ï¼Ÿæ¢ç§˜useRefçš„ä½¿ç”¨ä»¥åŠuserRefä¸useStateçš„åŒºåˆ«

## å‰è¨€

ä»Šå¤©åœ¨å†™ä»£ç çš„æ—¶å€™é‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼Œæˆ‘çš„ä¸€ä¸ªç»„ä»¶éœ€è¦ç»´æŠ¤ä¸€ä¸ªä¸éœ€è¦åœ¨é¡µé¢ä¸­æ¸²æŸ“çš„å˜é‡ã€‚é‚£ä¹ˆæˆ‘æƒ³ï¼Œæ—¢ç„¶å®ƒä¸éœ€è¦æ¸²æŸ“ï¼Œæˆ‘ç›´æ¥ç”¨`let`å˜é‡æ–°å»ºä¸€ä¸ªä¸å°±å¯ä»¥äº†å—ï¼Ÿ

ä½†æ˜¯å½“æˆ‘çœŸæ­£ç”¨è¿™ä¸ª`let`åˆ›å»ºçš„å˜é‡æ—¶ï¼Œæ‰æ„è¯†åˆ°å¤§äº‹ä¸å¥½ï¼ŒåŸæ¥è¿™ä¹ˆä½¿ç”¨å˜é‡æœ‰ä¸€ä¸ªå¤§é—®é¢˜ï¼

## ä¸ºä»€ä¹ˆè¦æœ‰hook

è¦è¯´æ˜é—®é¢˜æ˜¯ä»€ä¹ˆï¼Œæˆ‘ä»¬éœ€è¦å…ˆå¼„æ˜ç™½ä¸€ä»¶äº‹æƒ…ï¼Œ**æˆ‘ä»¬ä½¿ç”¨å‡½æ•°å¼ç»„ä»¶æ—¶æˆ‘ä»¬æ€ä¹ˆå»`render`** ï¼Ÿåœ¨æˆ‘ä»¬ä½¿ç”¨ç±»å¼ç»„ä»¶æ—¶ï¼Œ`rerender`å¯èƒ½æ˜¯ç®€å•çš„è°ƒç”¨ä¸€æ¬¡`render`æ–¹æ³•ï¼Œé‚£å¯¹äºå‡½æ•°å¼ç»„ä»¶å‘¢ï¼Ÿå‡½æ•°å¼ç»„ä»¶çš„`render`å†™åœ¨`return`è¯­å¥ä¸­ï¼Œå¾ˆæ˜æ˜¾æˆ‘ä»¬éœ€è¦é‡æ–°æ‰§è¡Œæ•´ä¸ªå‡½æ•°ã€‚

é‚£ä¹ˆæˆ‘åœ¨å‰è¨€éƒ¨åˆ†æåˆ°çš„é—®é¢˜å°±å‘¼ä¹‹æ¬²å‡ºäº†ï¼šç»„ä»¶æ¯æ¬¡æ¸²æŸ“æ›´æ–°éƒ½ä¼šä½¿å¾—å˜é‡å˜ä¸ºåˆå§‹å€¼ã€‚ä¹Ÿå°±æ˜¯è¯´æˆ‘åœ¨ç»„ä»¶çš„ä¸€ä¸ªå‡½æ•°ä¸­ä¿®æ”¹å˜é‡å¹¶æ›´æ–°ç»„ä»¶ï¼Œæƒ³åœ¨å¦ä¸€ä¸ªå‡½æ•°ä¸­ä½¿ç”¨æ—¶æˆ‘ä»¬è·å–åˆ°çš„å°±åªä¼šæ˜¯åˆå§‹å€¼äº†ã€‚

å¯ä»¥çœ‹åˆ°ï¼Œå‡½æ•°å¼ç»„ä»¶æ˜¯æ²¡æœ‰çŠ¶æ€çš„ï¼è€Œreactå¼•å…¥`hook`çš„åŸå› å°±æ˜¯è¡¥å…¨å‡½æ•°å¼ç»„ä»¶åœ¨è¿™æ–¹é¢çš„ç¼ºé™·ã€‚æ¯”å¦‚useStateï¼Œå½“å‡½æ•°é‡æ–°æ¸²æŸ“æ—¶ï¼Œstateèƒ½å¤Ÿä»çŠ¶æ€æ± ä¸­è·å–åˆ°ä¸Šæ¬¡renderçš„çŠ¶æ€ï¼ŒåƒuseEffectèƒ½æ ¹æ®å˜é‡æ¥ç¡®å®šæ˜¯å¦éœ€è¦æ¸²æŸ“ï¼Œä»è€Œèµ·åˆ°ç”Ÿå‘½å‘¨æœŸå‡½æ•°çš„ä½œç”¨ã€‚

ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæˆ‘ä»¬å¸Œæœ›æœ‰ä¸€ä¸ªèƒ½åœ¨æ¯æ¬¡æ¸²æŸ“çš„æ—¶å€™ä¸è¢«é‡æ–°åˆå§‹åŒ–çš„å˜é‡ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦å€ŸåŠ©hookäº†ã€‚

é‚£ä¹ˆé—®é¢˜åˆæ¥äº†ï¼Œæˆ‘ä»¬åº”è¯¥ç”¨å“ªä¸€ä¸ª`hook`å‘¢ï¼Ÿè¿™é‡Œæˆ‘æ¨èä¸€ä¸ªï¼š`useRef`ã€‚

## useRef

æˆ‘ä»¬ä½¿ç”¨`useRef()`åˆ›å»ºçš„å˜é‡ä¸ä¼šæ¯æ¬¡éƒ½è¢«é‡æ–°æ¸²æŸ“

```js
let count = 0 // æ¯æ¬¡renderéƒ½ä¼šinit
let count = useRef(0) // rerenderæ—¶ä¸ä¼šinit
```

`useRef`çš„ç‰¹æ€§å¦‚ä¸‹ï¼š

- refçš„å€¼é€šè¿‡`current`å±æ€§è·å–

- refæ˜¯å¯ä»¥æ›´æ”¹çš„

- æ›´æ”¹refçš„å€¼**ä¸ä¼š**å¼•èµ·`rerender`

- å¦‚æœrefçš„å€¼è¢«ç”¨äºæ¸²æŸ“ï¼Œé‚£ä¹ˆåˆ™ä¸å¯æ›´æ”¹

- ä¸å»ºè®®åœ¨ç»„ä»¶æ¸²æŸ“ä¸­**è¯»**å†™refçš„`current`ï¼Œæ¨èåœ¨`useEffect`ä¸`event handler`ä¸­ä½¿ç”¨ä½¿ç”¨`ref.current`

å¯ä»¥çœ‹åˆ°ï¼Œrefå°±æ˜¯ä¸ºæˆ‘ä»¬ä¿å­˜**ä¸ç”¨æ¯æ¬¡åˆå§‹åŒ–**è€Œä¸”**ä¸å¿…æ¸²æŸ“**çš„å˜é‡è€Œç”Ÿçš„ã€‚

### useRefä¸useState

é‚£ä¹ˆä¸ºä»€ä¹ˆæˆ‘ä»¬è¦ç”¨refè€Œä¸å»ä½¿ç”¨stateå‘¢ï¼Ÿè¿™ä¸¤ä¸ªhookæœ‰ä¸¤ä¸ªéå¸¸å¤§çš„åŒºåˆ«ï¼š

- **refä¸ä¼šå¼•èµ·rerenderï¼Œè€Œstateä¼š**ã€‚å½“æˆ‘ä»¬è°ƒç”¨setStateæ—¶ï¼Œä¼šè§¦å‘rerenderï¼Œè€Œåœ¨ä½¿ç”¨refå°±ä¸å¿…æ‹…å¿ƒè¿™ä¸ªï¼Œä½ å¯ä»¥éšæ„çš„ä½¿ç”¨

- **refæ˜¯åŒæ­¥çš„ï¼Œstateæ˜¯å¼‚æ­¥çš„**ã€‚å½“æˆ‘ä»¬åŒæ­¥çš„ä½¿ç”¨useStateæ›´æ–°æ•°æ®ä¹‹åï¼Œæˆ‘ä»¬ä¼šè·å–ä¸åˆ°æœ€æ–°çš„å€¼ï¼Œå› ä¸ºä»–æ˜¯å¼‚æ­¥æ›´æ–°çš„ã€‚è€Œrefåˆ™ä¸ä¼šæœ‰è¿™æ ·çš„é—®é¢˜ï¼Œä½ å¯ä»¥åœ¨æ›´æ–°ä¹‹åç«‹åˆ»è·å–åˆ°æœ€æ–°çš„å€¼ã€‚

æ‰€ä»¥å¯¹æˆ‘ç°åœ¨çš„éœ€æ±‚æ¥è¯´ï¼Œ`useRef`è¦æ¯”`useState`åˆé€‚çš„å¤šã€‚

### ä½¿ç”¨useRefæ“ä½œdom

useRefçš„å¦ä¸€ä¸ªé‡è¦çš„ä½œç”¨å°±æ˜¯æ“ä½œdomï¼Œæˆ‘ä»¬åœ¨è¿™è¾¹ä¹Ÿé¡ºå¸¦æä¸€ä¸‹å§ã€‚

æˆ‘ä»¬å¯ä»¥è¿™æ ·ä½¿ç”¨refï¼š

```jsx
const domRef = useRef(null)

function focusInput(){
    domRef.current.focus();
}

return (
&lt;&gt;
    &lt;input ref={domRef}/&gt;
    &lt;button onClick={focusInput}&gt;click to focus&lt;button&gt;
&lt;/&gt;
)
```

æˆ‘ä»¬é€šè¿‡jsxä¸­çš„`VNODE`çš„refå±æ€§å±æ€§ä¼ é€’æˆ‘ä»¬çš„refï¼Œè¿™æ ·reactä¼šåœ¨æ¸²æŸ“çš„æ—¶å€™è‡ªåŠ¨å°†`current`çš„å€¼è®¾ç½®ä¸ºnodeã€‚ç„¶åæˆ‘ä»¬å°±å¯ä»¥è®¿é—®åˆ°è¿™ä¸ªnodeäº†ã€‚

å½“è¿™ä¸ªnodeè¢«ä»é¡µé¢ä¸­ç§»é™¤æ—¶ï¼Œ`ref.current`ä¹Ÿä¼šè¢«è®¾ç½®ä¸º`null`

## æ€»ç»“

å¦‚æœä½ å¸Œæœ›åœ¨reactå‡½æ•°å¼ç»„ä»¶ä¸­ä¿å­˜ä¸€ä¸ªä¸ä¼šæ¯æ¬¡æ¸²æŸ“æ—¶æ›´æ–°å¹¶ä¸”æ— é¡»è¢«æ¸²æŸ“çš„å€¼ï¼Œé‚£ä¹ˆ`useRef`æ˜¯ä½ çš„ä¸äºŒä¹‹é€‰</p> </div> </div> </a>  </div><div class="card-item" data-astro-cid-p3vyftr4> <a href="/blog/technology/tools/slove_github_canlendar_no_response/" class="card-link" data-astro-cid-dohjnao5> <div class="card" data-astro-cid-dohjnao5> <div class="card-image" data-astro-cid-dohjnao5>  </div> <div class="card-content" data-astro-cid-dohjnao5> <h3 class="card-title" data-astro-cid-dohjnao5>è§£å†³æ’ä»¶ä½¿ç”¨GitHub calendar æ’ä»¶æ— å“åº”é—®é¢˜</h3> <p class="card-description" data-astro-cid-dohjnao5>æœ€è¿‘å¼€å§‹å‘æ˜å¥½ç”¨çš„hexoæ’ä»¶ï¼Œå…ˆç„å‡†çš„æ˜¯å¾ˆä¹…ä¹‹å‰å°±çœ‹è§è¿‡çš„å°å†°çš„GitHub Calendar

[æ•™ç¨‹ï¼šhexo-githubcalendar æ’ä»¶ 1.0 | å°å†°åšå®¢ (zfe.space)](https://zfe.space/post/hexo-githubcalendar.html)

ä½†æ˜¯æŒ‰ç…§ä»–æè¿°çš„æ–¹æ³•é…ç½®å®Œæˆä¹‹åï¼Œå‘ç°å¹¶æ²¡æœ‰ç”ŸæˆCalendarï¼Œäºæ˜¯æˆ‘å°±å¼€å§‹äº†æ¼«é•¿çš„æ’æŸ¥ã€‚

&lt;!--more--&gt;
## é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ

æˆ‘è¿™é‡Œå…ˆè¯´æˆ‘çš„é—®é¢˜ï¼Œå› ä¸ºæˆ‘æ˜¯ç”¨äº†fluidä¸»é¢˜ï¼Œæ‰€ä»¥æˆ‘å…ˆæ‰¾åˆ°äº†å°å†°ç»™å‡ºçš„fluidé…ç½®å‚æ•°ï¼Œå®é™…ä¸Šåªéœ€è¦å°†é…ç½®ä¸­çš„æœ€åä¸€è¡Œæ”¹ä¸ºï¼š

```yaml
plus_style: &quot;#github_container &gt; .position-relative &gt; .border{border:0!important}#github-calendar{position: relative;margin-top: -2rem;background-color: var(--board-bg-color);transition: background-color 0.2s ease-in-out;border-radius: 0.5rem;z-index: 3;-webkit-box-shadow: 0 12px 15px 0 rgb(0 0 0 / 24%), 0 17px 50px 0 rgb(0 0 0 / 19%);box-shadow: 0 12px 15px 0 rgb(0 0 0 / 24%), 0 17px 50px 0 rgb(0 0 0 / 19%);}&quot;
```

ä½†æ˜¯éšç€æˆ‘æŒ‰ç…§æ•™ç¨‹å®Œæ•´çš„é…ç½®å®Œå…¨ï¼Œå‘ç°å¹¶æ²¡æœ‰ç”¨ï¼Œåœ¨å¯¹åº”æ’ä»¶çš„æ²¡æœ‰å‡ºç°åœ¨å®ƒåº”è¯¥å‡ºç°çš„ä½ç½®ã€‚åæ¥ï¼Œè§‰å¾—fluidæœ‰å¾ˆå¤šé…ç½®éƒ½æ˜¯ç›´æ¥é…ç½®åœ¨`_config.fluid.yaml`ä¸­ï¼Œæˆ‘å°±å°è¯•ç€å°†é…ç½®æ–‡ä»¶å¤åˆ¶åˆ°è¿™ä¸ªæ–‡ä»¶ä¸€ä»½ï¼Œç»“æœé˜´å·®é˜³é”™çš„æˆåŠŸäº†ã€‚

åæ¥æˆ‘åˆåˆ é™¤äº†hexoè‡ªå¸¦çš„configä¸­çš„é…ç½®ï¼Œç»“æœåˆåˆ·ä¸å‡ºæ¥äº†ã€‚

**æ‰€ä»¥ï¼Œå¦‚æœä½ æ˜¯ä½¿ç”¨äº†æŸä¸ªä¸»é¢˜ï¼Œå¹¶ä¸”åˆ·ä¸å‡ºè¿™ä¸ªæ’ä»¶ï¼Œ&lt;font color=red&gt;ä½ å¯ä»¥å°†ä¸»é¢˜å’Œhexoçš„é…ç½®éƒ½åŠ å…¥æ’ä»¶é…ç½®&lt;/font&gt;**

## å…¶ä»–å¯èƒ½çš„é—®é¢˜

**è¿™ä¸ªæ’ä»¶æƒ³è¦ä½¿ç”¨åº”è¯¥ä¸æ˜¯åªé…ç½®ä¸€ä¸ª`_config.yaml`å°±å¯ä»¥äº†** ï¼Œä½ è¿˜éœ€è¦åœ¨å¯¹åº”çš„ç•Œé¢ï¼ˆenable_pageå±æ€§ä¸­å¯¹åº”çš„ï¼‰åŠ å…¥ç›¸åº”çš„å…ƒç´ ï¼Œå¦‚æœæ˜¯layout.typeæ˜¯id,é‚£ä¹ˆå°±è¦æ’å…¥:

```html
&lt;div id=&quot;è¿™é‡Œæ›¿æ¢ä¸ºlayout.name&quot;&gt;
&lt;/div&gt;
```

å¦‚æœä½ çš„layout.typeæ˜¯classï¼Œé‚£ä¹ˆä½ è¦ä¿è¯ä½ é‚£ä¸ªç•Œé¢åˆn-1ä¸ªnameä¸º`layout.name`çš„ä»£ç å—</p> </div> </div> </a>  </div><div class="card-item" data-astro-cid-p3vyftr4> <a href="/blog/technology/tools/use_ts_in_ws/" class="card-link" data-astro-cid-dohjnao5> <div class="card" data-astro-cid-dohjnao5> <div class="card-image" data-astro-cid-dohjnao5>  </div> <div class="card-content" data-astro-cid-dohjnao5> <h3 class="card-title" data-astro-cid-dohjnao5>åœ¨webStormä¸­è¿è¡Œtsï¼Œä¿®å¤--require ts-node/registeré—®é¢˜</h3> <p class="card-description" data-astro-cid-dohjnao5>å¦‚æœæˆ‘ä»¬æƒ³è¦åœ¨webStormä¸­åƒè¿è¡Œjsæ–‡ä»¶é‚£æ ·è¿è¡Œtsæ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥ï¼š

1. å…¨å±€å®‰è£…tsï¼š`npm install -g typescript`
2. å…¨å±€å®‰è£…ts-nodeï¼š`npm install -g ts-node`
3. å®‰è£…æ’ä»¶ï¼šFile-Settings-Pluginsï¼Œæœç´¢`Run Configuration for TypeScript`
    ![img.png](use_ts_in_ws/img.png)
    å¦‚æœä½ åœ¨tsæ–‡ä»¶ä¸­å³é”®æ²¡æœ‰å‡ºç°è¿è¡Œä»£ç çš„é€‰é¡¹ï¼Œå°è¯•é‡å¯IDE
4. é…ç½®æ’ä»¶ï¼šå¦‚æœä½ è¿è¡Œä»£ç æ˜¾ç¤ºé”™è¯¯`&quot;&lt;node_path&gt;/node&quot;--require ts-node/register`é”™è¯¯ï¼Œé‚£ä¹ˆè¯·ä½ ç‚¹å‡»ä¸Šæ–¹èœå•æ çš„ run-Edit Configurationsï¼Œé€‰æ‹©ts-nodeè·¯å¾„
    ![img.png](../../essay/prose/imperial_edict/img1.png)

å¦‚æœä½ å®‰è£…tsçš„æ—¶å€™é™¤äº†å…¨å±€å®‰è£…è¿˜æ‰§è¡Œäº†å…¨å±€å®‰è£…ï¼Œå¯èƒ½ä¸ä¼šå‡ºç°ç¬¬å››æ­¥ã€‚æ˜¯å¦éœ€è¦æœ¬åœ°å®‰è£…å¯ä»¥æ ¹æ®æ‚¨çš„å–œå¥½è‡ªè¡Œå†³å®šã€‚</p> </div> </div> </a>  </div><div class="card-item" data-astro-cid-p3vyftr4> <a href="/blog/technology/react/rn_input_selection/" class="card-link" data-astro-cid-dohjnao5> <div class="card" data-astro-cid-dohjnao5> <div class="card-image" data-astro-cid-dohjnao5>  </div> <div class="card-content" data-astro-cid-dohjnao5> <h3 class="card-title" data-astro-cid-dohjnao5>React Native ç§»åŠ¨å…‰æ ‡ï¼Œéƒ½ä»€ä¹ˆå¹´ä»£è¿˜åœ¨ç”¨ä¼ ç»ŸsetNativeProps</h3> <p class="card-description" data-astro-cid-dohjnao5># React Native ç§»åŠ¨å…‰æ ‡ï¼Œéƒ½ä»€ä¹ˆå¹´ä»£è¿˜åœ¨ç”¨ä¼ ç»ŸsetNativePropsï¼Ÿ

å¯¹æˆ‘çš„æ•…äº‹ä¸æ„Ÿå…´è¶£çš„ç›´æ¥è·³è½¬æ­£æ–‡éƒ¨åˆ†ã€‚

## å¿µå¨

ä»Šå¤©é‡åˆ°ä¸€ä¸ªbugï¼Œè¦è§£å†³è¿™ä¸ªbugå‘¢å°±éœ€è¦æ‰‹åŠ¨ç§»åŠ¨inputçš„å…‰æ ‡ã€‚ç„¶åæˆ‘å‘ç°ä¹‹å‰æˆ‘åœ¨~~æŠ„~~å€Ÿäººå®¶çš„ä»£ç çš„æ—¶å€™å·²ç»å€Ÿè¿‡ç§»åŠ¨å…‰æ ‡çš„ä»£ç äº†ï¼š

```typescript
inputRef.current.setNativeProps({selection: {start: 1, end: 1}});
```

äºæ˜¯æˆ‘å…ˆå»æœç´¢äº†ä¸€ä¸‹`setNativeProps`çš„ç”¨æ³•ï¼Œåœ¨æœ€æ–°ç‰ˆæœ¬çš„RNæ–‡æ¡£ä¸Šæ˜ç¡®çš„ç»™å‡ºäº†è¿™ä¸ªæ–¹æ³•çš„ä½¿ç”¨ç¤ºä¾‹ï¼Œä½†æ˜¯å´æ²¡æœ‰APIæ–‡æ¡£ã€‚ã€‚ã€‚ğŸ˜“

ä¹Ÿå°±æ˜¯è¯´ï¼Œç†è®ºä¸Šï¼Œè¿™ä¸ªæ–¹æ³•æ˜¯å¯ä»¥ä½¿ç”¨çš„ï¼Œäºæ˜¯æˆ‘åˆæœç´¢äº†ä¸€ä¸‹å¦‚ä½•ä½¿ç”¨è¿™ä¸ªæ–¹æ³•å®ç°ç§»åŠ¨å…‰æ ‡ï¼Œç»“æœæˆ‘å‘ç°**ä¸Šè¿°å†™æ³•æ˜¯å®Œå…¨æ­£ç¡®çš„ï¼Œä½†æ˜¯å®Œå…¨æ²¡ç”¨ï¼**

æˆ‘è¿˜å‘ç°è¿™äº›æ–‡ç« è¿˜è¯´æœ‰ä¸€ä¸ª`_lastNativeSelection`å±æ€§å¯ä¾›è¯»å–ï¼Œä½†æ˜¯æˆ‘åªè¯»åˆ°äº†`undefined`ã€‚äºæ˜¯ä¹ï¼Œæˆ‘å¤§èƒ†çš„æ€€ç–‘ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¯ä¸æ˜¯å·²ç»å¯„äº†ğŸ˜°

ç„¶åæˆ‘æ‰“å°äº†ä¸€ä¸‹`inputRef.current`å‘ç°æœ‰è¿™ä¹ˆä¸€ä¸ªå±æ€§ï¼š`&quot;setSelection&quot;: [Function setSelection],`ï¼Œäºæ˜¯ä¹æˆ‘å¤§èƒ†å°è¯•ï¼Œè¯·çœ‹ä¸‹æ–‡â€¦â€¦

## æ­£æ–‡

ä¸è¦å†ä½¿ç”¨`setNativeProps`æ–¹æ³•äº†ï¼Œè¿™ä¸ªæ–¹æ³•ç–‘ä¼¼ä¸å†å—åˆ°æ”¯æŒäº†ã€‚å¦‚æœä½ éœ€è¦æ“ä½œinputçš„å…‰æ ‡ï¼Œè¯·ç›´æ¥ä½¿ç”¨`setSelection`ã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š

```tsx
inputRef.current.setSelection(1, 1);
```

å‡½æ•°ç­¾åï¼ˆ&lt;u&gt;æˆ‘çŒœçš„&lt;/u&gt;ï¼‰ï¼š

`setSelection(selectionStart,selectionEnd)`

- `selectionStart`
  - è¢«é€‰ä¸­çš„ç¬¬ä¸€ä¸ªå­—ç¬¦çš„ä½ç½®ç´¢å¼•ï¼Œä» 0 å¼€å§‹ã€‚å¦‚æœè¿™ä¸ªå€¼æ¯”å…ƒç´ çš„Â `value`Â é•¿åº¦è¿˜å¤§ï¼Œåˆ™ä¼šè¢«çœ‹ä½œÂ `value`Â æœ€åä¸€ä¸ªä½ç½®çš„ç´¢å¼•ã€‚
- `selectionEnd`
  - : è¢«é€‰ä¸­çš„æœ€åä¸€ä¸ªå­—ç¬¦çš„Â *ä¸‹ä¸€ä¸ª*Â ä½ç½®ç´¢å¼•ã€‚å¦‚æœè¿™ä¸ªå€¼æ¯”å…ƒç´ çš„ value é•¿åº¦è¿˜å¤§ï¼Œåˆ™ä¼šè¢«çœ‹ä½œ value æœ€åä¸€ä¸ªä½ç½®çš„ç´¢å¼•ã€‚</p> </div> </div> </a>  </div><div class="card-item" data-astro-cid-p3vyftr4> <a href="/blog/technology/react/rn_use_realm/" class="card-link" data-astro-cid-dohjnao5> <div class="card" data-astro-cid-dohjnao5> <div class="card-image" data-astro-cid-dohjnao5>  </div> <div class="card-content" data-astro-cid-dohjnao5> <h3 class="card-title" data-astro-cid-dohjnao5>react native å¦‚ä½•æ­£ç¡®ä½¿ç”¨realm</h3> <p class="card-description" data-astro-cid-dohjnao5># react native å¦‚ä½•æ­£ç¡®ä½¿ç”¨realm

Realmæ˜¯ä¸€ä¸ªæ”¯æŒäº‘åŒæ­¥çš„å¿«é€Ÿçš„æ–°å‹çš„æ•°æ®åº“ï¼Œæ˜¯SQLiteçš„æ›¿ä»£å“ã€‚Realmçš„å®˜ç½‘å®é™…ä¸Šå¯¹Realmçš„ä½¿ç”¨æœ‰ç›¸å½“è¯¦ç»†çš„è®²è§£ï¼Œä½†æ˜¯å¯¹äºæˆ‘ä»¬å®é™…å¼€å‘ä¸­å¯èƒ½å‡ºç°çš„ä¸€äº›é—®é¢˜å®˜æ–¹æ–‡æ¡£å¯èƒ½ä¼šæœ‰æ²¡æœ‰æåˆ°çš„åœ°æ–¹ï¼Œè¿™ç¯‡åšå®¢æ—¨åœ¨è®°å½•ç¬”è€…åœ¨ä½¿ç”¨realmæ—¶è¸©åˆ°çš„ä¸€äº›å‘

## å®‰è£…

å®‰è£…è¿‡ç¨‹å®˜æ–¹è¯´çš„å¾ˆæ˜ç¡®ï¼Œä½†æ˜¯è¦æ³¨æ„æˆ‘ä»¬éœ€è¦å®‰è£…ä¸¤ä¸ªä¾èµ–ï¼š

```shell
# å®‰è£…realmåº“
npm install realm
# å®‰è£…ä¸€äº›æ“ä½œrealmçš„hooksç­‰
npm install @realm/react
```

åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­ä¹Ÿéœ€è¦æ³¨æ„ï¼Œæˆ‘ä»¬å¼•å…¥ä¾èµ–çš„ä½ç½®ã€‚

## ä½¿ç”¨

ç›®å‰çš„realmæ”¯æŒä¸¤ç§å†™æ³•ï¼Œä¸€ç§æ˜¯ç›´æ¥å¼•å…¥çš„æ–¹æ³•ï¼š

```tsx
import React from &#39;react&#39;;
import {RealmProvider} from &#39;@realm/react&#39;;
// Import your models
import {Profile} from &#39;../../../models&#39;;

export const AppWrapper = () =&gt; {
  return (
    &lt;RealmProvider schema={[Profile]}&gt;
      &lt;RestOfApp /&gt;
    &lt;/RealmProvider&gt;
  );
};
```

åœ¨ä½ éœ€è¦çš„æ—¶å€™ä»…éœ€è¦ï¼š

```ts
import {useQuery} from &#39;@realm/react&#39;;
const profiles = useQuery(Profile);
```

å¦‚æœä½ æœ‰å¤šä¸ªschemaï¼Œæˆ–è€…è¯´å¤šä¸ªè¡¨ï¼Œç›´æ¥åœ¨`RealmProvider`ä¸­çš„`schema`å±æ€§ä¸­æ·»åŠ å³å¯ï¼Œå› ä¸ºè¿™é‡Œå®ƒæ¥å—ä¸€ä¸ª**æ•°ç»„**å˜›ã€‚

## æ›´å¥½çš„ä½¿ç”¨

ä½†æ˜¯æˆ‘è®¤ä¸ºä¸Šè¿°æ–¹æ³•å¹¶ä¸æ˜¯æœ€å¥½çš„ä½¿ç”¨æ–¹æ³•ï¼Œæˆ‘è¿™é‡Œè¿˜æ˜¯æ¨èç›´æ¥ä½¿ç”¨`createRealmContext`çš„æ–¹å¼ï¼Œè¿™æ ·èƒ½å¤Ÿè®©æˆ‘ä»¬æ›´çµæ´»çš„ä½¿ç”¨`realm config`ã€‚

```tsx
// é…ç½®realm
const config: Realm.Configuration = {
  schema: [Settings, DarftSchema],
  schemaVersion: 1,
  onMigration: (oldRealm, newRealm) =&gt; {
    newRealm.deleteAll();
  },
};


// åˆ›å»ºProvider
const {RealmProvider, useRealm, useObject, useQuery} =
  createRealmContext(config);


// åŒ…è£¹Appå‰©ä½™éƒ¨åˆ†
function App(): React.JSX.Element {
  return (
    &lt;RealmProvider&gt;
      &lt;RealmContext.Provider value={{useRealm, useObject, useQuery}}&gt;
        &lt;LayoutWarp /&gt;
      &lt;/RealmContext.Provider&gt;
    &lt;/RealmProvider&gt;
  );
}
```

ä½†æ˜¯ç”±äºæˆ‘ä»¬ä½¿ç”¨äº†è¿™ç§æ–¹å¼ä¹‹åï¼Œå°±ä¸èƒ½ä½¿ç”¨ç›´æ¥å¼•ç”¨çš„å…¨å±€apiäº†ï¼Œæ‰€ä»¥æˆ‘ä»¬å¿…é¡»æƒ³åŠæ³•æŠŠapiä¼ é€’ç»™åä»£ç»„ä»¶ã€‚æˆ‘çš„å»ºè®®æ˜¯ï¼š`useContext`

```ts
export const RealmContext = createContext({
  useRealm,
  useObject,
  useQuery,
});
```

åœ¨éœ€è¦ä½¿ç”¨è¿™äº›apiçš„å­ç»„ä»¶è°ƒç”¨ï¼š

```ts
const {useRealm, useObject} = useContext(RealmContext);
const realm = useRealm();
```

è¿™æ ·å°±ä¸ä¼šæŠ¥é”™äº†ã€‚</p> </div> </div> </a>  </div> </div>  <nav class="pagination" aria-label="Pagination Navigation" data-astro-cid-d776pwuy><a href="/page/5/" class="pagination-link pagination-prev" title="ä¸Šä¸€é¡µ" data-astro-cid-d776pwuy>
â† ä¸Šä¸€é¡µ
</a><div class="pagination-numbers" data-astro-cid-d776pwuy><a href="/" class="pagination-number " data-astro-cid-d776pwuy>1</a><span class="pagination-ellipsis" data-astro-cid-d776pwuy>...</span><a href="/page/4/" class="pagination-number " data-astro-cid-d776pwuy>4</a><a href="/page/5/" class="pagination-number " data-astro-cid-d776pwuy>5</a><a href="/page/6/" class="pagination-number active" aria-current="page" data-astro-cid-d776pwuy>6</a><a href="/page/7/" class="pagination-number " data-astro-cid-d776pwuy>7</a></div><a href="/page/7/" class="pagination-link pagination-next" title="ä¸‹ä¸€é¡µ" data-astro-cid-d776pwuy>
ä¸‹ä¸€é¡µ â†’
</a></nav> </main> <footer data-astro-cid-sz7xmlte>
&copy; 2026 @charlesix59. All rights reserved.
<div class="social-links" data-astro-cid-sz7xmlte> <a href="https://https://github.com/charlesix59" target="_blank" data-astro-cid-sz7xmlte> <span class="sr-only" data-astro-cid-sz7xmlte>find me on Github</span> <svg viewBox="0 0 16 16" aria-hidden="true" width="32" height="32" astro-icon="social/github" data-astro-cid-sz7xmlte><path fill="currentColor" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z" data-astro-cid-sz7xmlte></path></svg> </a> </div> </footer>  </body></html>